!function(r){var i={};function o(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return r[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}o.m=r,o.c=i,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(r,i,function(t){return e[t]}.bind(null,i));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=14)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r(8),u=0,l=5,c=10,h=11,o=12,n=13,d=14,x=1e-10;function A(){return new Float32Array(16)}function s(t,e,r){var i=e[1]*r[2]-e[2]*r[1],o=e[2]*r[0]-e[0]*r[2],n=e[0]*r[1]-e[1]*r[0];t[0]=i,t[1]=o,t[2]=n}function i(t){return Math.hypot(t[0],t[1],t[2])}function f(t,e,r,i,o,n,a,s,u,l,c,h,d,f,p,v){var m=A();return m[0]=t,m[1]=e,m[2]=r,m[3]=i,m[4]=o,m[5]=n,m[6]=a,m[7]=s,m[8]=u,m[9]=l,m[10]=c,m[11]=h,m[12]=d,m[13]=f,m[14]=p,m[15]=v,m}function T(){return f(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}function p(t,e,r){var i=e[0],o=e[1],n=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=e[9],f=e[10],p=e[11],v=e[12],m=e[13],A=e[14],g=e[15],y=r[0],b=r[1],_=r[2],w=r[3];return t[0]=y*i+b*s+_*h+w*v,t[1]=y*o+b*u+_*d+w*m,t[2]=y*n+b*l+_*f+w*A,t[3]=y*a+b*c+_*p+w*g,y=r[4],b=r[5],_=r[6],w=r[7],t[4]=y*i+b*s+_*h+w*v,t[5]=y*o+b*u+_*d+w*m,t[6]=y*n+b*l+_*f+w*A,t[7]=y*a+b*c+_*p+w*g,y=r[8],b=r[9],_=r[10],w=r[11],t[8]=y*i+b*s+_*h+w*v,t[9]=y*o+b*u+_*d+w*m,t[10]=y*n+b*l+_*f+w*A,t[11]=y*a+b*c+_*p+w*g,y=r[12],b=r[13],_=r[14],w=r[15],t[12]=y*i+b*s+_*h+w*v,t[13]=y*o+b*u+_*d+w*m,t[14]=y*n+b*l+_*f+w*A,t[15]=y*a+b*c+_*p+w*g,t}function v(t,e,r){var i=e[0],o=e[1],n=e[2],a=e[3],s=r[0]*i+r[4]*o+r[8]*n+r[12]*a,u=r[1]*i+r[5]*o+r[9]*n+r[13]*a,l=r[2]*i+r[6]*o+r[10]*n+r[14]*a,c=r[3]*i+r[7]*o+r[11]*n+r[15]*a;t[0]=s,t[1]=u,t[2]=l,t[3]=c}function m(t,e,r,i,o,n){var a=Math.cos(.5*e)/Math.sin(.5*e),s=a*i/r;return t[u]=s,t[l]=a,t[h]=-1,t[c]=n/(o-n),t[d]=-n*o/(n-o),t}function g(t,e,r,i){var o,n,a,s,u,l,c,h,d,f,p=e[0],v=e[1],m=e[2],A=i[0],g=i[1],y=i[2],b=r[0],_=r[1],w=r[2];return Math.abs(p-b)<x&&Math.abs(v-_)<x&&Math.abs(m-w)<x?T():(c=p-b,h=v-_,d=m-w,o=g*(d*=f=1/Math.hypot(c,h,d))-y*(h*=f),n=y*(c*=f)-A*d,a=A*h-g*c,(f=Math.hypot(o,n,a))?(o*=f=1/f,n*=f,a*=f):a=n=o=0,s=h*a-d*n,u=d*o-c*a,l=c*n-h*o,(f=Math.hypot(s,u,l))?(s*=f=1/f,u*=f,l*=f):l=u=s=0,t[0]=o,t[1]=s,t[2]=c,t[3]=0,t[4]=n,t[5]=u,t[6]=h,t[7]=0,t[8]=a,t[9]=l,t[10]=d,t[11]=0,t[12]=-(o*p+n*v+a*m),t[13]=-(s*p+u*v+l*m),t[14]=-(c*p+h*v+d*m),t[15]=1,t)}function y(t,e){var r=e[0],i=e[1],o=e[2],n=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],v=e[13],m=e[14],A=e[15],g=r*s-i*a,y=r*u-o*a,b=r*l-n*a,_=i*u-o*s,w=i*l-n*s,x=o*l-n*u,T=c*v-h*p,E=c*m-d*p,S=c*A-f*p,L=h*m-d*v,P=h*A-f*v,M=d*A-f*m,C=g*M-y*P+b*L+_*S-w*E+x*T;return C?(C=1/C,t[0]=(s*M-u*P+l*L)*C,t[1]=(o*P-i*M-n*L)*C,t[2]=(v*x-m*w+A*_)*C,t[3]=(d*w-h*x-f*_)*C,t[4]=(u*S-a*M-l*E)*C,t[5]=(r*M-o*S+n*E)*C,t[6]=(m*b-p*x-A*y)*C,t[7]=(c*x-d*b+f*y)*C,t[8]=(a*P-s*S+l*T)*C,t[9]=(i*S-r*P-n*T)*C,t[10]=(p*w-v*b+A*g)*C,t[11]=(h*b-c*w-f*g)*C,t[12]=(s*E-a*L-u*T)*C,t[13]=(r*L-i*E+o*T)*C,t[14]=(v*y-p*_-m*g)*C,t[15]=(c*_-h*y+d*g)*C,t):null}function b(t,e,r,i){return t[o]=e,t[n]=r,t[d]=i,t}function _(t,e){if(t===e){var r=e[1],i=e[2],o=e[3],n=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=n,t[11]=e[14],t[12]=o,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}e.toRadian=function(t){return t/180*Math.PI},e.toDegree=function(t){return t/Math.PI*180},e.matZero=A,e.vec3Cross=s,e.vec3Dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},e.vec3Length=i,e.vec3AddMul=function(t,e,r,i){t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i},e.vec3Add=function(t,e,r){t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2]},e.vec3Sub=function(t,e,r){t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2]},e.vec3Div=function(t,e,r){var i=1/r;t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i},e.vec3Mul=function(t,e,r){var i,o,n;n=a.isNumber(r)?o=i=r:(i=r[0],o=r[1],r[2]),t[0]=e[0]*i,t[1]=e[1]*o,t[2]=e[2]*n},e.vec3Normalize=function(t){var e=1/i(t);t[0]*=e,t[1]*=e,t[2]*=e},e.quatFromAngleAxis=function(t,e,r){var i=Math.sin(.5*e);t[0]=Math.cos(.5*e),t[1]=r[0]*i,t[2]=r[1]*i,t[3]=r[2]*i},e.quatConcat=function(t,e,r){var i=e[0]*r[0]-e[1]*r[1]-e[2]*r[2]-e[3]*r[3],o=e[0]*r[1]+e[1]*r[0]+e[2]*r[3]-e[3]*r[2],n=e[0]*r[2]+e[2]*r[0]+e[3]*r[1]-e[1]*r[3],a=e[0]*r[3]+e[3]*r[0]+e[1]*r[2]-e[2]*r[1];t[0]=i,t[1]=o,t[2]=n,t[3]=a},e.quatMul=function(t,e,r){var i=[e[1],e[2],e[3]],o=[0,0,0],n=[0,0,0];s(o,i,r),s(n,i,o);var a=e[0];t[0]=r[0]+2*(o[0]*a+n[0]),t[1]=r[1]+2*(o[1]*a+n[1]),t[2]=r[2]+2*(o[2]*a+n[2])},e.quatToMatrix=function(t,e,r,i){var o=e*e,n=e*r,a=e*i,s=e*t,u=r*r,l=r*i,c=r*t,h=i*i,d=i*t;return f(1-2*(u+h),2*(n+d),2*(a-c),0,2*(n-d),1-2*(o+h),2*(l+s),0,2*(a+c),2*(l-s),1-2*(o+u),0,0,0,0,1)},e.mat4=f,e.matIdentity=T,e.matIdentity_=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.matClone=function(t){var e=A();return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.matMul=function(t,e){return p(A(),t,e)},e.matMul_=p,e.matTransform=function(t,e){var r=new Float32Array(4);return v(r,t,e),r},e.matTransform_=v,e.matPerspective=function(t,e,r,i,o){return m(A(),t,e,r,i,o)},e.matPerspective_=m,e.matOrtho_=function(t,e,r,i,o,n,a){var s=1/(e-r),u=1/(i-o),l=1/(n-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+r)*s,t[13]=(o+i)*u,t[14]=(a+n)*l,t[15]=1,t},e.matLookAt=function(t,e,r){return g(A(),t,e,r)},e.matLookAt_=g,e.matInvert=function(t){return y(A(),t)},e.matInvert_=y,e.matScale=function(t,e,r){var i=T();return i[u]=t,i[l]=e,i[c]=r,i},e.matTranslate=function(t,e,r){return b(T(),t,e,r)},e.matTranslate_=b,e.matTranspose=function(t){return _(A(),t)},e.matTranspose_=_},function(t,e,r){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),a=(Object.defineProperty(s.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),s.prototype.createChildNode=function(t){var e=new s;return(e.entity=t).node=e,this.children.push(e),e._parent=this,e},s.prototype.dispose=function(){for(var t=0,e=this.materials;t<e.length;t++)e[t].dispose();for(var r=0,i=this.children;r<i.length;r++)i[r].dispose();this.materials.splice(0),this.children.splice(0),null!=this.entity&&(this.entity.dispose(),this.entity=null)},s.prototype.setEntity=function(t){this.entity&&(this.entity.node=null),(this.entity=t)&&(t.node=this)},s.prototype.addChildNode=function(t){this.children.push(t),t._parent=this},Object.defineProperty(s.prototype,"localTransform",{get:function(){return this._localTransform},enumerable:!0,configurable:!0}),s.prototype.setLocalTransform=function(t){this._localTransform.set(t),this.notifyWorldDirty()},Object.defineProperty(s.prototype,"worldTransform",{get:function(){return this._worldDirty&&this.evaluateWorldTransform(),this._worldTransform},enumerable:!0,configurable:!0}),s.prototype.evaluateWorldTransform=function(){if(this._worldDirty=!1,this._parent){var t=this._parent.worldTransform;n.matMul_(this._worldTransform,t,this._localTransform)}else this._worldTransform.set(this._localTransform)},s.prototype.notifyWorldDirty=function(){this._worldDirty=!0;for(var t=0;t<this.children.length;t++)this.children[t].notifyWorldDirty();this.entity&&this.entity.notifyWorldDirty()},s);function s(){this.name="",this.children=[],this.entity=null,this.geometricTransform=n.matIdentity(),this.materials=[],this._localTransform=n.matIdentity(),this._worldTransform=n.matIdentity(),this._worldDirty=!0,this._parent=null}e.SceneNode=a;var u=(l.prototype.notifyWorldDirty=function(){},l.prototype.dispose=function(){},l);function l(){}e.Entity=u;var c,h=(o(d,c=u),d);function d(){return null!==c&&c.apply(this,arguments)||this}e.Renderable=h},function(t,e,r){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var n,a,s,u,l=r(6),c=(h.prototype.getAttribLocation=function(t){var e=this.renderer.gl;switch(t){case"NORMAL":return e.getAttribLocation(this.program,"a_normal");case"TEXCOORD":return e.getAttribLocation(this.program,"a_texcoord");case"POSITION":return e.getAttribLocation(this.program,"a_position");case"TANGENT":return e.getAttribLocation(this.program,"a_tangent");case"BITANGENT":case"BINORMAL":return e.getAttribLocation(this.program,"a_binormal");default:return-1}},h.prototype.loadUniforms=function(t,e){var r=e.gl;this.program=t,this.renderer=e,this.u_worldViewProjection=r.getUniformLocation(t,"u_worldViewProjection"),this.u_world=r.getUniformLocation(t,"u_world"),this.u_viewInverse=r.getUniformLocation(t,"u_viewInverse"),this.u_worldInverseTranspose=r.getUniformLocation(t,"u_worldInverseTranspose")},h);function h(){}e.MaterialDescriptor=c,(a=n=e.CompareFunction||(e.CompareFunction={}))[a.Never=512]="Never",a[a.Less=513]="Less",a[a.Equal=514]="Equal",a[a.LEqual=515]="LEqual",a[a.Greater=516]="Greater",a[a.NotEqual=517]="NotEqual",a[a.GEqual=518]="GEqual",a[a.Always=519]="Always",(u=s=e.BlendFactor||(e.BlendFactor={}))[u.Zero=0]="Zero",u[u.One=1]="One",u[u.SRC_COLOR=768]="SRC_COLOR",u[u.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",u[u.SRC_ALPHA=770]="SRC_ALPHA",u[u.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",u[u.DST_ALPHA=772]="DST_ALPHA",u[u.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",u[u.DST_COLOR=774]="DST_COLOR",u[u.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",u[u.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",u[u.CONSTANT_COLOR=32769]="CONSTANT_COLOR",u[u.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",u[u.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",u[u.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA";var d=function(){this.cullFace=!0,this.depthTest=!0,this.depthWrite=!0,this.depthFunction=n.Less,this.blend=!1,this.sourceBlendFactor=s.One,this.destinationBlendFactor=s.Zero};e.RenderState=d;var f=(p.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeImpl())},p.prototype.disposeImpl=function(){},p.prototype.disposeTextures=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this.descriptor.renderer.whiteTex,i=0,o=t;i<o.length;i++){var n=o[i];n instanceof l.TextureUnit&&n!=r&&n.dispose()}},p.prototype.bindBuffer=function(t,e){this.descriptor.renderer.gl.bindBuffer},p.prototype.bindTexture=function(t,e){var r=e&&e.loaded?e:this.descriptor.renderer.whiteTex,i=this.activeTextures++,o=this.descriptor.renderer.gl;o.activeTexture(o.TEXTURE0+i),o.bindTexture(o.TEXTURE_2D,r.texture),o.uniform1i(t,i)},p.prototype.applyUniforms=function(t){var e=t.gl,r=this.descriptor;this.activeTextures=0,this.activeBuffers=0,e.useProgram(r.program),t.setRenderState(this.renderState);var i=t.variables;this.identityMVP?e.uniformMatrix4fv(r.u_worldViewProjection,!1,i.identity):e.uniformMatrix4fv(r.u_worldViewProjection,!1,i.worldViewProjection),r.u_world&&e.uniformMatrix4fv(r.u_world,!1,i.world),r.u_viewInverse&&e.uniformMatrix4fv(r.u_viewInverse,!1,i.viewInverse),r.u_worldInverseTranspose&&e.uniformMatrix4fv(r.u_worldInverseTranspose,!1,i.worldInverseTranspose)},p);function p(t){this.renderState=new d,this.identityMVP=!1,this.activeTextures=0,this.activeBuffers=0,this.disposed=!1,this.transparency=0,this.descriptor=t}e.Material=f;var v,m=(o(A,v=c),A.prototype.loadUniforms=function(n,t){v.prototype.loadUniforms.call(this,n,t);var a=t.gl;(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,i=t;r<i.length;r++){var o=i[r];this[o]=a.getUniformLocation(n,"u_"+o)}}).bind(this)("globalAmbient","ambientColor","albedoColor","albedoTexture","eyePosition","metallic","roughness","enableMetallicRoughness","enableNormalMapping","normalTexture","metallicRoughnessTexture","occlusion","occlusionTexture","emissiveColor","emissiveTexture","numLights");var e=a.getUniformBlockIndex(n,"LightBuffer");a.uniformBlockBinding(n,e,0)},A);function A(){return null!==v&&v.apply(this,arguments)||this}e.PbrMaterialDescriptor=m;var g,y=(o(b,g=f),b.prototype.disposeImpl=function(){this.disposeTextures(this.albedo,this.metallicRoughnessTexture,this.occlusion,this.normal,this.emissive,this.specular)},b.prototype.applyUniforms=function(t){var e=this.descriptor,r=t.gl;if(g.prototype.applyUniforms.call(this,t),r.uniform3f(e.ambientColor,this.ambient[0],this.ambient[1],this.ambient[2]),this.albedo instanceof l.TextureUnit?(r.uniform3f(e.albedoColor,1,1,1),this.bindTexture(e.albedoTexture,this.albedo)):(r.uniform3f(e.albedoColor,this.albedo[0],this.albedo[1],this.albedo[2]),this.bindTexture(e.albedoTexture,null)),this.normal instanceof l.TextureUnit?(this.bindTexture(e.normalTexture,this.normal),r.uniform1i(e.enableNormalMapping,1)):r.uniform1i(e.enableNormalMapping,0),this.bindTexture(e.metallicRoughnessTexture,this.metallicRoughnessTexture),this.metallicRoughnessTexture instanceof l.TextureUnit?(r.uniform1f(e.metallic,1),r.uniform1f(e.roughness,1)):(r.uniform1f(e.metallic,this.metallic),r.uniform1f(e.roughness,this.roughness)),this.occlusion instanceof l.TextureUnit?(r.uniform1f(e.occlusion,1),this.bindTexture(e.occlusionTexture,this.occlusion)):(r.uniform1f(e.occlusion,this.occlusion),this.bindTexture(e.occlusionTexture,null)),this.emissive instanceof l.TextureUnit)r.uniform3f(e.emissiveColor,1,1,1),this.bindTexture(e.emissiveTexture,this.emissive);else{var i=this.emissive;r.uniform3f(e.emissiveColor,i[0],i[1],i[2]),this.bindTexture(e.emissiveTexture,null)}var o=t.camera.node.worldTransform;r.uniform3f(e.eyePosition,o[12],o[13],o[14]);var n=t.variables;r.uniform1i(e.numLights,this.lighting?n.lights.length:0),r.bindBufferBase(r.UNIFORM_BUFFER,0,n.lightBuffer)},b);function b(t){var e=g.call(this,t)||this;return e.ambient=[0,0,0],e.albedo=[.5,.3,.6],e.metallic=0,e.roughness=0,e.occlusion=0,e.emissive=[0,0,0],e.lighting=!0,e}e.PbrMaterial=y;var _,w=(o(x,_=c),x.prototype.loadUniforms=function(n,t){_.prototype.loadUniforms.call(this,n,t);var a=t.gl;(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,i=t;r<i.length;r++){var o=i[r];this[o]=a.getUniformLocation(n,o)}}).bind(this)("u_ambient","u_diffuse","u_diffuseSampler","u_emissive","u_emissiveSampler","u_specular","u_specularSampler","u_shininess","u_specularFactor","u_numLights","u_eyePosition","u_materialAlpha","u_enableNormalMapping","u_normalTexture");var e=a.getUniformBlockIndex(n,"LightBuffer");a.uniformBlockBinding(n,e,0)},x);function x(){return null!==_&&_.apply(this,arguments)||this}e.PhongMaterialDescriptor=w;var T,E=(o(S,T=f),S.prototype.disposeImpl=function(){this.disposeTextures(this.diffuse,this.specular,this.emissive,this.normal)},S.prototype.applyUniforms=function(t){var e=this.descriptor,i=t.gl,r=function(t,e,r){t instanceof Array?(this.bindTexture(r,null),i.uniform3f(e,t[0],t[1],t[2])):(this.bindTexture(r,t),i.uniform3f(e,1,1,1))}.bind(this);T.prototype.applyUniforms.call(this,t),i.uniform3f(e.u_ambient,this.ambient[0],this.ambient[1],this.ambient[2]),r(this.diffuse,e.u_diffuse,e.u_diffuseSampler),r(this.specular,e.u_specular,e.u_specularSampler),r(this.emissive,e.u_emissive,e.u_emissiveSampler),this.specular instanceof Array?i.uniform3f(e.u_specular,this.specular[0],this.specular[1],this.specular[2]):i.uniform3f(e.u_specular,0,0,0),i.uniform1f(e.u_shininess,this.shininess),i.uniform1f(e.u_specularFactor,this.specularFactor),i.uniform1f(e.u_materialAlpha,1-this.transparency);var o=t.camera.node.worldTransform;i.uniform3f(e.u_eyePosition,o[12],o[13],o[14]);var n=t.variables;i.uniform1i(e.u_numLights,this.lighting?n.lights.length:0),i.bindBufferBase(i.UNIFORM_BUFFER,0,n.lightBuffer),this.normal&&this.normal.loaded?(this.bindTexture(e.u_normalTexture,this.normal),i.uniform1i(e.u_enableNormalMapping,1)):i.uniform1i(e.u_enableNormalMapping,0)},S);function S(t){var e=T.call(this,t)||this;return e.ambient=[0,0,0],e.diffuse=[.5,.3,.6],e.specular=[.2,.2,.2],e.shininess=45,e.specularFactor=1,e.transparentColor=[0,0,0],e.emissive=[0,0,0],e.normal=null,e.lighting=!0,e}e.PhongMaterial=E;var L,P=(o(M,L=c),M.prototype.loadUniforms=function(t,e){L.prototype.loadUniforms.call(this,t,e);var r=e.gl;this.u_color=r.getUniformLocation(t,"u_color")},M);function M(){return null!==L&&L.apply(this,arguments)||this}e.WireframeMaterialDescriptor=P;var C,B=(o(D,C=f),D.prototype.applyUniforms=function(t){var e=this.descriptor;C.prototype.applyUniforms.call(this,t);var r=this.color;t.gl.uniform3f(e.u_color,r[0],r[1],r[2])},D);function D(t){var e=C.call(this,t)||this;return e.color=[0,1,0],e}e.WireframeMaterial=B},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VertexShaders={Axis:"#version 300 es\nuniform mat4 u_worldViewProjection;uniform mat4 u_worldInverseTranspose;in vec4 a_position;in vec3 a_normal;in vec2 a_uv;out vec2 v_uv;out vec3 v_normal;void main(){gl_Position=(u_worldViewProjection*a_position);v_normal=normalize((u_worldInverseTranspose*vec4(a_normal,0)).xyz);v_normal=a_normal;v_uv=a_uv;}",BackgroundVertex:"#version 300 es\nin vec4 a_position;out vec4 out_pos;void main(){gl_Position=a_position;}",Box:"#version 300 es\nuniform mat4 u_worldViewProjection;in vec4 a_position;in vec2 a_uv;out vec4 v_color;out vec2 v_uv;void main(){gl_Position=(u_worldViewProjection*a_position);v_uv=a_uv;}",GridVertex:"#version 300 es\nuniform mat4 u_worldViewProjection;in vec4 a_position;void main(){gl_Position=(u_worldViewProjection*a_position);}",Overlay:"#version 300 es\nuniform mat4 u_transform;in vec2 a_position;in vec2 a_uv;in vec4 a_color;out vec4 v_position;out vec2 v_uv;out vec4 v_color;void main(){v_position=(u_transform*vec4(a_position,0,1));gl_Position=v_position;v_uv=a_uv;v_color=a_color;}",StandardMaterial:"#version 300 es\nuniform mat4 u_worldViewProjection;uniform vec3 u_lightWorldPos;uniform mat4 u_world;uniform mat4 u_viewInverse;uniform mat4 u_worldInverseTranspose;in vec3 a_position;in vec3 a_normal;in vec2 a_texcoord;in vec3 a_tangent;in vec3 a_binormal;out vec4 v_position;out vec4 v_fragPos;out vec2 v_texCoord;out vec3 v_normal;out vec3 v_surfaceToLight;out vec3 v_surfaceToView;out mat3 v_TBN;const mat4 biasMat=mat4(0.5,0.0,0.0,0.0,0.0,0.5,0.0,0.0,0.0,0.0,1.0,0.0,0.5,0.5,0.0,1.0);void main(){v_texCoord=vec2(a_texcoord.x,1.0-a_texcoord.y);v_position=(u_worldViewProjection*vec4(a_position,1));v_fragPos=u_world*vec4(a_position,1);v_normal=normalize((u_worldInverseTranspose*vec4(a_normal,0)).xyz);v_surfaceToLight=u_lightWorldPos-v_fragPos.xyz;v_surfaceToView=(u_viewInverse[3]-v_fragPos).xyz;gl_Position=v_position;vec3 T=normalize(vec3(u_world*vec4(a_tangent,0)));vec3 B=normalize(vec3(u_world*vec4(a_binormal,0)));vec3 N=normalize(vec3(u_world*vec4(a_normal,0)));v_TBN=mat3(T,B,N);}",Text:"#version 300 es\nuniform mat4 u_vp;in vec3 a_pos;in vec2 a_uv;out vec2 v_uv;void main(){gl_Position=(u_vp*vec4(a_pos,1));v_uv=a_uv;}"},e.FragmentShaders={Axis:"#version 300 es\nprecision mediump float;uniform sampler2D u_texture;uniform vec3 u_lightPos;in vec3 v_normal;in vec4 v_color;in vec2 v_uv;out vec4 o_color;void main(){vec4 c=texture(u_texture,v_uv);float coefficient=max(0.1,dot(v_normal,normalize(u_lightPos)));float a=(1.0-c.a)*coefficient;o_color=vec4(a,a,a,1);}",BackgroundFragment:"#version 300 es\nprecision mediump float;uniform float height;in vec4 out_pos;out vec4 outColor;uniform vec4 upper;uniform vec4 lower;void main(){float v=gl_FragCoord.y / height;outColor=mix(lower,upper,v);}",Box:"#version 300 es\nprecision mediump float;in vec2 v_uv;uniform vec4 u_color;out vec4 o_color;void main(){o_color=u_color;}",GridFragment:"#version 300 es\nprecision mediump float;out vec4 outColor;void main(){outColor=vec4(0.5,0.5,0.5,1);}",Indicator:"#version 300 es\nprecision mediump float;in vec4 v_position;uniform float u_time;out vec4 fragColor;void main(){vec2 uv=v_position.xy;if(dot(uv,uv)> 1.0){discard;}else{float rad=atan(uv.y,uv.x);vec3 col=0.5+0.5*sin(u_time+rad+vec3(0,2,4));fragColor=vec4(col,1.0);}}",Overlay:"#version 300 es\nprecision mediump float;uniform sampler2D u_icons;in vec2 v_uv;in vec4 v_color;out vec4 o_color;void main(){vec4 t=texture(u_icons,v_uv);o_color=vec4(t.rgb*t.a+v_color.rgb*(1.0-t.a),1.0);}",Phong:"#version 300 es\nprecision mediump float;in vec4 v_position;in vec4 v_fragPos;in vec2 v_texCoord;in vec3 v_normal;in mat3 v_TBN;uniform vec3 u_ambient;uniform vec3 u_diffuse;uniform sampler2D u_diffuseSampler;uniform sampler2D u_emissiveSampler;uniform vec3 u_emissive;uniform vec3 u_specular;uniform sampler2D u_specularSampler;uniform float u_shininess;uniform float u_specularFactor;struct LightSource{vec4 position;vec3 direction;float spotCosCutoff;vec3 attenuation;float spotExponent;vec4 color;};\n#define MAX_LIGHTS 10\nlayout(std140)uniform LightBuffer{LightSource lights[MAX_LIGHTS];};uniform int u_numLights;uniform vec3 u_eyePosition;uniform float u_materialAlpha;uniform bool u_enableNormalMapping;uniform sampler2D u_normalTexture;out vec4 outColor;vec3 calculateLight(LightSource light,vec3 lightDir,vec3 norm,vec3 viewDir,vec3 specular){float diff=max(dot(norm,lightDir),0.0);vec3 spec=vec3(0);vec3 reflectDir=reflect(-lightDir,norm);if(u_specularFactor > 0.0){spec=specular*u_specularFactor*pow(max(dot(viewDir,reflectDir),0.0),u_shininess)*light.color.rgb;}vec3 ambient=light.color.rgb*0.1f;vec3 diffuse=light.color.rgb*diff;return ambient+diffuse+spec;}vec3 calculateDirectionLight(LightSource light,vec3 norm,vec3 viewDir,vec3 specular){vec3 color=calculateLight(light,light.direction,norm,viewDir,specular);return color;}vec3 calculatePointLight(LightSource light,vec3 norm,vec3 viewDir,vec3 specular){float distance=length(light.position.xyz-v_fragPos.xyz);float attenuation=light.attenuation.x+light.attenuation.y*distance+light.attenuation.z*(distance*distance);vec3 lightDir=normalize(light.position.xyz-v_fragPos.xyz);vec3 color=calculateLight(light,lightDir,norm,viewDir,specular);return color/attenuation;}vec3 calculateSpotLight(LightSource light,vec3 norm,vec3 viewDir,vec3 specular){float distance=length(light.position.xyz-v_fragPos.xyz);vec3 lightDir=normalize(light.position.xyz-v_fragPos.xyz);float spotDot=dot(-lightDir,light.direction);if(spotDot < light.spotCosCutoff){return vec3(0,0,0);}else{vec3 color=calculateLight(light,lightDir,norm,viewDir,specular);return color*(1.0-(1.0-spotDot)*1.0 /(1.0-light.spotCosCutoff));}}void main(){vec3 norm;if(u_enableNormalMapping){norm=texture(u_normalTexture,v_texCoord).rgb;norm=normalize(norm*2.0-1.0);norm=normalize(v_TBN*norm);}else{norm=normalize(v_normal);}vec3 viewDir=normalize(u_eyePosition-v_fragPos.xyz);vec4 rgba=texture(u_diffuseSampler,v_texCoord);float alpha=u_materialAlpha*rgba.w;vec3 diffuseColor=rgba.xyz*u_diffuse;vec3 specularColor=texture(u_specularSampler,v_texCoord).xyz*u_specular;vec3 emissiveColor=texture(u_emissiveSampler,v_texCoord).xyz*u_emissive;vec3 result=vec3(0,0,0);if(u_numLights > 0){for(int i=0;i < u_numLights;i++){if(lights[i].position.w==0.0){result+=calculateDirectionLight(lights[i],norm,viewDir,specularColor);}else if(lights[i].spotCosCutoff==-1.0){result+=calculatePointLight(lights[i],norm,viewDir,specularColor);}else{result+=calculateSpotLight(lights[i],norm,viewDir,specularColor);}}result*=diffuseColor;}else{result=diffuseColor;}result+=emissiveColor+u_ambient;result=result /(result+vec3(1.0));outColor=vec4(result,alpha);}",Text:"#version 300 es\nprecision mediump float;uniform sampler2D u_tex;in vec2 v_uv;out vec4 o_color;void main(){vec4 t=texture(u_tex,v_uv);o_color=t.rrrr;}",Wireframe:"#version 300 es\nprecision mediump float;uniform vec3 u_color;out vec4 outColor;void main(void){outColor=vec4(u_color,1);}",pbr:"#version 300 es\nprecision mediump float;\n#define PI 3.14159265359\nin vec4 v_position;in vec4 v_fragPos;in vec2 v_texCoord;in vec3 v_normal;in mat3 v_TBN;uniform vec3 u_globalAmbient;uniform vec3 u_ambientColor;uniform bool u_enableNormalMapping;uniform sampler2D u_normalTexture;uniform vec3 u_albedoColor;uniform sampler2D u_albedoTexture;uniform vec3 u_eyePosition;uniform float u_metallic;uniform float u_roughness;uniform sampler2D u_metallicRoughnessTexture;uniform float u_occlusion;uniform sampler2D u_occlusionTexture;uniform vec3 u_emissiveColor;uniform sampler2D u_emissiveTexture;uniform int u_numLights;struct Light{vec4 position;vec3 direction;float spotCosCutoff;vec3 attenuation;float spotExponent;vec4 color;};\n#define MAX_LIGHTS 10\nlayout(std140)uniform LightBuffer{Light lights[MAX_LIGHTS];};out vec4 outColor;vec3 FresnelSchlickRoughness(float cosTheta,vec3 F0,float roughness){return F0+(max(vec3(1.0-roughness),F0)-F0)*pow(1.0-cosTheta,5.0);}float DistributionGGX(vec3 N,vec3 H,float roughness){float a=roughness*roughness;float a2=a*a;float NdotH=max(dot(N,H),0.0);float NdotH2=NdotH*NdotH;float nom=a2;float denom=(NdotH2*(a2-1.0)+1.0);denom=PI*denom*denom;return nom / denom;}float GeometrySchlickGGX(float NdotV,float roughness){float r=(roughness+1.0);float k=(r*r)/ 8.0;float nom=NdotV;float denom=NdotV*(1.0-k)+k;return nom / denom;}float GeometrySmith(vec3 N,vec3 V,vec3 L,float roughness){float NdotV=max(dot(N,V),0.0);float NdotL=max(dot(N,L),0.0);float ggx2=GeometrySchlickGGX(NdotV,roughness);float ggx1=GeometrySchlickGGX(NdotL,roughness);return ggx1*ggx2;}vec3 GetNormal(){if(!u_enableNormalMapping)return v_normal;vec3 norm=texture(u_normalTexture,v_texCoord).rgb;norm=normalize(norm*2.0-1.0);norm=normalize(v_TBN*norm);return norm;}void main(void){vec3 norm=GetNormal();vec3 albedo=vec3(texture(u_albedoTexture,v_texCoord))*u_albedoColor;vec3 result=albedo;vec3 emissiveColor=texture(u_emissiveTexture,v_texCoord).xyz*u_emissiveColor;vec3 Lo=vec3(0.0);vec4 mr=texture(u_metallicRoughnessTexture,v_texCoord);float kMetallic=mr.x*u_metallic;float kRoughness=mr.y*u_roughness;if(u_numLights > 0){vec3 N=norm;vec3 V=normalize(u_eyePosition-v_fragPos.xyz);vec3 F0=vec3(0.04);F0=mix(F0,albedo,kMetallic);vec3 F=FresnelSchlickRoughness(max(dot(N,V),0.0),F0,kRoughness);vec3 kS=F;vec3 kD=vec3(1.0)-kS;kD*=1.0-kMetallic;vec3 Lo=vec3(0.0);for(int i=0;i < u_numLights;i++){vec3 L;float attenuation=1.0;if(lights[i].spotCosCutoff !=-1.0){vec3 delta=lights[i].position.xyz-v_fragPos.xyz;L=normalize(delta);float spotDot=dot(-L,lights[i].direction);if(spotDot < lights[i].spotCosCutoff){attenuation=0.0;}else{attenuation=(1.0-(1.0-spotDot)*1.0 /(1.0-lights[i].spotCosCutoff));}}else if(lights[i].position.w !=0.0){vec3 delta=lights[i].position.xyz-v_fragPos.xyz;L=normalize(delta);float distance=length(delta);vec3 att=lights[i].attenuation;attenuation=1.0 /(att.x+att.y*distance+att.z*(distance*distance));}else{L=lights[i].direction;}vec3 H=normalize(V+L);vec3 radiance=lights[i].color.xyz*attenuation;float NDF=DistributionGGX(N,H,kRoughness);float G=GeometrySmith(N,V,L,kRoughness);vec3 nominator=NDF*G*F;float denominator=4.0*max(dot(V,N),0.0)*max(dot(L,N),0.0)+0.001;vec3 brdf=nominator / denominator;float NdotL=max(dot(N,L),0.0);Lo+=(kD*albedo / PI+brdf)*radiance*NdotL;}vec3 ambient=u_ambientColor*u_globalAmbient+vec3(0.03)*albedo*texture(u_occlusionTexture,v_texCoord).x*u_occlusion;result=ambient+Lo;result=result /(result+vec3(1.0));result=pow(result,vec3(1.0/2.2));}float shadow=1.0;result=result*shadow+emissiveColor;outColor=vec4(result,1);}"},e.Assets={Icons:"data:image/png;base64,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",Fonts:"data:image/png;base64,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",FontSize:[128,64],Alphabet:".0123456789cmknuftydi"}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var c=r(8),i=(h.evaluateSize=function(t){switch(t){case 5120:case 5121:return 1;case 5122:case 5123:return 2;case 5124:case 5125:case 5126:default:return 4}},h.prototype.bind=function(){this.gl.bindVertexArray(this.vao)},Object.defineProperty(h.prototype,"hasIndice",{get:function(){return null!=this.indexBuffer},enumerable:!0,configurable:!0}),h.prototype.loadData=function(t,e){var r=this.gl;r.bindVertexArray(this.vao),this.buffer||(this.buffer=r.createBuffer()),r.bindBuffer(r.ARRAY_BUFFER,this.buffer),r.bufferData(r.ARRAY_BUFFER,t,r.STATIC_DRAW),e&&(this.indexBuffer||(this.indexBuffer=r.createBuffer()),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this.indexBuffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e,r.STATIC_DRAW));for(var i=0;i<this.attribs.length;i++){var o=this.attribs[i];r.enableVertexAttribArray(i),r.vertexAttribPointer(i,o.size,o.type,!1,this.stride,o.offset)}},h.prototype.dispose=function(){var t=this.gl;t&&(t.deleteVertexArray(this.vao),this.buffer&&t.deleteBuffer(this.buffer),this.indexBuffer&&t.deleteBuffer(this.indexBuffer),this.gl=null,this.buffer=null,this.indexBuffer=null,this.vao=null)},h.prototype.applyLayout=function(){},h);function h(t,e){this.gl=t,this.attribs=[],this.vao=t.createVertexArray();for(var r,i=0,o=0,n=0,a=e;n<a.length;n++){var s=a[n],u=(r=s,c.isNumber(r)?{size:r,type:5126}:(r.type||(r.type=5126),r));this.attribs.push(u),c.isNullOrUndefined(u.location)&&(u.location=o);var l=u.size*h.evaluateSize(u.type);u.offset=i,i+=l,o++}this.stride=i}e.VertexArrayObject=i},function(t,e,r){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var s,n,a=r(1),u=r(0);(n=s=e.ProjectionType||(e.ProjectionType={}))[n.Ortho=0]="Ortho",n[n.Perspective=1]="Perspective";var l,c,h,d=(l=a.Entity,o(f,l),Object.defineProperty(f.prototype,"fov",{get:function(){return this._fov},set:function(t){this._pdirty=!0,this._fov=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"near",{get:function(){return this._near},set:function(t){this._pdirty=!0,this._near=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"far",{get:function(){return this._far},set:function(t){this._pdirty=!0,this._far=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"width",{get:function(){return this._width},set:function(t){this._pdirty=!0,this._width=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"height",{get:function(){return this._height},set:function(t){this._pdirty=!0,this._height=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"projectionType",{get:function(){return this._projectionType},set:function(t){this._pdirty=!0,this._projectionType=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"up",{get:function(){return this._up},set:function(t){this._up=t,this._vdirty=!0},enumerable:!0,configurable:!0}),f.prototype.lookAt=function(t,e,r){this._vdirty=!0,this._lookAt[0]=t,this._lookAt[1]=e,this._lookAt[2]=r,this._useLookAt=!0},f.prototype.setDirection=function(t){this._direction[0]=t[0],this._direction[1]=t[1],this._direction[2]=t[2],this._vdirty=!0,this._useLookAt=!1},Object.defineProperty(f.prototype,"direction",{get:function(){if(!this._useLookAt)return this._direction.slice(0);var t=[0,0,0],e=this.node.worldTransform,r=[e[12],e[13],e[14]];return u.vec3Sub(t,this._lookAt,r),u.vec3Normalize(t),t},enumerable:!0,configurable:!0}),f.prototype.update=function(){if(this._pdirty)if(this._pdirty=!1,this._projectionType==s.Perspective){var t=this._fov/180*Math.PI;u.matPerspective_(this.projection,t,this._width,this._height,this._near,this._far)}else{var e=.5*this._width,r=.5*this._height;u.matOrtho_(this.projection,-e,e,-r,r,this._near,this._far)}if(this._vdirty){this._vdirty=!1;var i=this.node.worldTransform,o=[i[12],i[13],i[14]],n=this._lookAt;if(!this._useLookAt){var a=this._direction;n=[o[0]+a[0],o[1]+a[1],o[2]+a[2]]}u.matLookAt_(this.view,o,n,this._up)}},f.prototype.notifyWorldDirty=function(){this._vdirty=!0},f);function f(){var t=null!==l&&l.apply(this,arguments)||this;return t._pdirty=!0,t._vdirty=!0,t._fov=45,t._near=10,t._far=1e3,t._width=400,t._height=300,t._projectionType=s.Perspective,t._lookAt=[0,0,0],t._direction=[1,0,0],t._useLookAt=!0,t._up=[0,1,0],t.projection=u.matIdentity(),t.view=u.matIdentity(),t}(h=c=e.LightType||(e.LightType={}))[h.Omni=0]="Omni",h[h.Directional=1]="Directional",h[h.Spot=2]="Spot";var p,v=(o(m,p=d),m);function m(){var t=null!==p&&p.apply(this,arguments)||this;return t.type=c.Omni,t.color=[1,1,1],t.falloff=45,t.hotSpot=0,t.constantAttenuation=.1,t.linearAttenuation=.1,t.quadraticAttenuation=0,t.intensity=100,t}e.Light=v;var A,g=(o(y,A=d),y);function y(){return null!==A&&A.apply(this,arguments)||this}e.Camera=g},function(t,e,r){"use strict";var a,i;Object.defineProperty(e,"__esModule",{value:!0}),(i=a=a||{})[i.Loading=0]="Loading",i[i.Loaded=1]="Loaded",i[i.Disposed=2]="Disposed";var o=(Object.defineProperty(n.prototype,"loaded",{get:function(){return this.state==a.Loaded},enumerable:!0,configurable:!0}),n.prototype.load=function(t,e){void 0===e&&(e=null);var r=this.gl;this.url=t,this.image=new Image,this.image.addEventListener("load",function(t){r.bindTexture(r.TEXTURE_2D,this.texture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,this.image),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,this.magFilter),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,this.minFilter),r.generateMipmap(r.TEXTURE_2D),r.bindTexture(r.TEXTURE_2D,null),this.setState(a.Loaded)}.bind(this)),this.image.src=t},n.prototype.setState=function(t){this.state=t,this.renderer.invalidate()},n.prototype.loadFromPixels=function(t,e,r,i){var o=this.gl,n=new Uint8Array([t,e,r,i]);o.bindTexture(o.TEXTURE_2D,this.texture),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,1,1,0,o.RGBA,o.UNSIGNED_BYTE,n),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST),this.setState(a.Loaded)},n.prototype.dispose=function(){this.state!=a.Disposed&&(this.setState(a.Disposed),this.gl.deleteTexture(this.texture),this.ondispose&&this.ondispose.call(this))},n);function n(t){this.state=a.Loading;var e=t.gl;this.gl=e,this.renderer=t,this.texture=e.createTexture(),this.magFilter=e.LINEAR,this.minFilter=e.LINEAR_MIPMAP_NEAREST}e.TextureUnit=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(15);e.A3DRenderer=i.A3DRenderer;var o=r(5);e.Camera=o.Camera,e.Light=o.Light;var n=r(1);e.SceneNode=n.SceneNode;var a=r(2);e.PhongMaterial=a.PhongMaterial;var s=r(0);e.matTranslate=s.matTranslate;var u=r(9);e.Grid=u.Grid;var l=r(23);e.Plane=l.Plane;var c=r(5);e.LightType=c.LightType;var h=r(24);e.calculateBoundingBox=h.calculateBoundingBox;var d=r(13);e.StandardMovement=d.StandardMovement;var f=r(13);e.OrbitalMovement=f.OrbitalMovement;var p=r(25);e.A3DWLoader=p.default},function(t,P,M){(function(a){var e=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),r={},i=0;i<e.length;i++)r[e[i]]=Object.getOwnPropertyDescriptor(t,e[i]);return r},s=/%[sdj%]/g;P.format=function(t){if(!y(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(u(arguments[r]));return e.join(" ")}r=1;for(var i=arguments,o=i.length,n=String(t).replace(s,function(t){if("%%"===t)return"%";if(o<=r)return t;switch(t){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(t){return"[Circular]"}default:return t}}),a=i[r];r<o;a=i[++r])A(a)||!l(a)?n+=" "+a:n+=" "+u(a);return n},P.deprecate=function(t,e){if(void 0!==a&&!0===a.noDeprecation)return t;if(void 0===a)return function(){return P.deprecate(t,e).apply(this,arguments)};var r=!1;return function(){if(!r){if(a.throwDeprecation)throw new Error(e);a.traceDeprecation?console.trace(e):console.error(e),r=!0}return t.apply(this,arguments)}};var t,i={};function u(t,e){var r={seen:[],stylize:n};return 3<=arguments.length&&(r.depth=arguments[2]),4<=arguments.length&&(r.colors=arguments[3]),m(e)?r.showHidden=e:e&&P._extend(r,e),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),d(r,t,r.depth)}function o(t,e){var r=u.styles[e];return r?"["+u.colors[r][0]+"m"+t+"["+u.colors[r][1]+"m":t}function n(t,e){return t}function d(e,r,i){if(e.customInspect&&r&&T(r.inspect)&&r.inspect!==P.inspect&&(!r.constructor||r.constructor.prototype!==r)){var t=r.inspect(i,e);return y(t)||(t=d(e,t,i)),t}var o=function(t,e){if(b(e))return t.stylize("undefined","undefined");if(y(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(g(e))return t.stylize(""+e,"number");if(m(e))return t.stylize(""+e,"boolean");if(A(e))return t.stylize("null","null")}(e,r);if(o)return o;var n=Object.keys(r),a=function(t){var r={};return t.forEach(function(t,e){r[t]=!0}),r}(n);if(e.showHidden&&(n=Object.getOwnPropertyNames(r)),x(r)&&(0<=n.indexOf("message")||0<=n.indexOf("description")))return f(r);if(0===n.length){if(T(r)){var s=r.name?": "+r.name:"";return e.stylize("[Function"+s+"]","special")}if(_(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(w(r))return e.stylize(Date.prototype.toString.call(r),"date");if(x(r))return f(r)}var u,l="",c=!1,h=["{","}"];v(r)&&(c=!0,h=["[","]"]),T(r)&&(l=" [Function"+(r.name?": "+r.name:"")+"]");return _(r)&&(l=" "+RegExp.prototype.toString.call(r)),w(r)&&(l=" "+Date.prototype.toUTCString.call(r)),x(r)&&(l=" "+f(r)),0!==n.length||c&&0!=r.length?i<0?_(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),u=c?function(e,r,i,o,t){for(var n=[],a=0,s=r.length;a<s;++a)E(r,String(a))?n.push(p(e,r,i,o,String(a),!0)):n.push("");return t.forEach(function(t){t.match(/^\d+$/)||n.push(p(e,r,i,o,t,!0))}),n}(e,r,i,a,n):n.map(function(t){return p(e,r,i,a,t,c)}),e.seen.pop(),function(t,e,r){if(60<t.reduce(function(t,e){return 0,0<=e.indexOf("\n")&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0))return r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1];return r[0]+e+" "+t.join(", ")+" "+r[1]}(u,l,h)):h[0]+l+h[1]}function f(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,e,r,i,o,n){var a,s,u;if((u=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?s=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(s=t.stylize("[Setter]","special")),E(i,o)||(a="["+o+"]"),s||(t.seen.indexOf(u.value)<0?-1<(s=A(r)?d(t,u.value,null):d(t,u.value,r-1)).indexOf("\n")&&(s=n?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n")):s=t.stylize("[Circular]","special")),b(a)){if(n&&o.match(/^\d+$/))return s;a=(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.stylize(a,"string"))}return a+": "+s}function v(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function A(t){return null===t}function g(t){return"number"==typeof t}function y(t){return"string"==typeof t}function b(t){return void 0===t}function _(t){return l(t)&&"[object RegExp]"===r(t)}function l(t){return"object"==typeof t&&null!==t}function w(t){return l(t)&&"[object Date]"===r(t)}function x(t){return l(t)&&("[object Error]"===r(t)||t instanceof Error)}function T(t){return"function"==typeof t}function r(t){return Object.prototype.toString.call(t)}function c(t){return t<10?"0"+t.toString(10):t.toString(10)}P.debuglog=function(e){if(b(t)&&(t=a.env.NODE_DEBUG||""),e=e.toUpperCase(),!i[e])if(new RegExp("\\b"+e+"\\b","i").test(t)){var r=a.pid;i[e]=function(){var t=P.format.apply(P,arguments);console.error("%s %d: %s",e,r,t)}}else i[e]=function(){};return i[e]},(P.inspect=u).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},P.isArray=v,P.isBoolean=m,P.isNull=A,P.isNullOrUndefined=function(t){return null==t},P.isNumber=g,P.isString=y,P.isSymbol=function(t){return"symbol"==typeof t},P.isUndefined=b,P.isRegExp=_,P.isObject=l,P.isDate=w,P.isError=x,P.isFunction=T,P.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},P.isBuffer=M(17);var h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function E(t,e){return Object.prototype.hasOwnProperty.call(t,e)}P.log=function(){console.log("%s - %s",function(){var t=new Date,e=[c(t.getHours()),c(t.getMinutes()),c(t.getSeconds())].join(":");return[t.getDate(),h[t.getMonth()],e].join(" ")}(),P.format.apply(P,arguments))},P.inherits=M(18),P._extend=function(t,e){if(!e||!l(e))return t;for(var r=Object.keys(e),i=r.length;i--;)t[r[i]]=e[r[i]];return t};var S="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function L(t,e){if(!t){var r=new Error("Promise was rejected with a falsy value");r.reason=t,t=r}return e(t)}P.promisify=function(n){if("function"!=typeof n)throw new TypeError('The "original" argument must be of type Function');if(S&&n[S]){var t;if("function"!=typeof(t=n[S]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,S,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var r,i,t=new Promise(function(t,e){r=t,i=e}),e=[],o=0;o<arguments.length;o++)e.push(arguments[o]);e.push(function(t,e){t?i(t):r(e)});try{n.apply(this,e)}catch(t){i(t)}return t}return Object.setPrototypeOf(t,Object.getPrototypeOf(n)),S&&Object.defineProperty(t,S,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,e(n))},P.promisify.custom=S,P.callbackify=function(n){if("function"!=typeof n)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);var r=t.pop();if("function"!=typeof r)throw new TypeError("The last argument must be of type Function");function i(){return r.apply(o,arguments)}var o=this;n.apply(this,t).then(function(t){a.nextTick(i,null,t)},function(t){a.nextTick(L,t,i)})}return Object.setPrototypeOf(t,Object.getPrototypeOf(n)),Object.defineProperties(t,e(n)),t}}).call(this,M(16))},function(t,e,r){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var n,a=r(10),c=r(3),h=r(2),d=r(0),s=r(1),f=r(11),p=r(4),u=(n=a.Primitive,o(l,n),l.prototype.build=function(t){this.material=t.createMaterial("grid");var e=this.material.renderState;e.depthTest=!0,e.depthWrite=!0,e.blend=!1,e.sourceBlendFactor=h.BlendFactor.SRC_ALPHA,e.destinationBlendFactor=h.BlendFactor.DST_ALPHA;for(var a=[],r=-100;r<=100;r++)a.push(-100,r,0),a.push(100,r,0);for(var i=-100;i<=100;i++)a.push(i,-100,0),a.push(i,100,0);function o(t,e){for(var r=0;r<a.length;r+=3){var i=r+t,o=r+e,n=a[i];a[i]=a[o],a[o]=n}}switch(this.up){case"x":o(0,2);break;case"y":o(1,2)}var n=this.gl;this.createGeometry(n.LINES,a)},l);function l(t){var e=n.call(this)||this;return e.up=t,e}e.Grid=u;var v,m=(v=s.Renderable,o(A,v),A.prototype.render=function(t){var e=this.renderer.gl;e.useProgram(this.program),this.renderer.setRenderState(this.renderState),this.vao.bind();var r=this.renderer.variables;e.uniformMatrix4fv(this.u_wvp,!1,r.worldViewProjection);var i=this.color;e.uniform4f(this.u_color,i[0],i[1],i[2],1),e.drawElements(e.TRIANGLES,36,e.UNSIGNED_BYTE,0)},A.prototype.dispose=function(){this.renderer.gl.deleteProgram(this.program),this.vao.dispose()},A);function A(t,e){var r=v.call(this)||this;r.renderState=new h.RenderState,r.color=e,r.renderer=t,r.program=t.createShader(c.VertexShaders.Box,c.FragmentShaders.Box);var i=t.gl;r.vao=new p.VertexArrayObject(i,[3,2]);var o=new Float32Array([-1,-1,1,0,0,1,-1,1,0,1,1,1,1,1,1,-1,1,1,1,0,-1,-1,-1,1,1,-1,1,-1,1,0,1,1,-1,0,0,1,-1,-1,0,1,-1,1,-1,1,0,-1,1,1,0,0,1,1,1,0,1,1,1,-1,1,1,-1,-1,-1,0,0,1,-1,-1,0,1,1,-1,1,1,1,-1,-1,1,1,0,1,-1,-1,0,0,1,1,-1,0,1,1,1,1,1,1,1,-1,1,1,0,-1,-1,-1,0,0,-1,-1,1,0,1,-1,1,1,1,1,-1,1,-1,1,0]),n=new Uint8Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]);return r.vao.loadData(o,n),r.u_wvp=i.getUniformLocation(r.program,"u_worldViewProjection"),r.u_color=i.getUniformLocation(r.program,"u_color"),r.renderState.depthTest=!0,r.renderState.depthWrite=!0,r}e.Box=m;var g=(y.prototype.render=function(t,e){if(this.visible){var r=t.gl,i=this.width,o=this.height,n=t.size;r.viewport(n[0]-i,n[1]-o,i,o),r.useProgram(this.program),this.renderer.setRenderState(this.renderState),this.vao.bind();var a=t.variables,s=t.camera,u=(s.fov,Math.PI,a.view),l=[u[2],u[6],u[10]];d.matTranslate_(a.world,2.5*-u[2],2.5*-u[6],2.5*-u[10]),a.setWorld(a.world),d.matLookAt_(u,l,[0,0,0],s.up),d.matMul_(a.worldView,u,a.world),d.matMul_(a.viewProjection,a.project,a.worldView),r.uniformMatrix4fv(this.u_wvp,!1,a.viewProjection),r.uniform3f(this.u_lightPos,l[0],l[1],l[2]),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.texture.texture),r.uniform1i(this.u_texture,0),r.drawElements(r.TRIANGLES,36,r.UNSIGNED_BYTE,0),r.flush()}},y.prototype.dispose=function(){this.renderer.gl.deleteProgram(this.program),this.vao.dispose()},y);function y(t){this.renderState=new h.RenderState,this.width=64,this.height=64,this.visible=!0,this.renderer=t,this.program=t.createShader(c.VertexShaders.Axis,c.FragmentShaders.Axis);var e=t.gl;this.vao=new p.VertexArrayObject(e,[3,3,2]);var r=f.iconRect(f.Icon.Front),i=f.iconRect(f.Icon.Back),o=f.iconRect(f.Icon.Top),n=f.iconRect(f.Icon.Bottom),a=f.iconRect(f.Icon.Left),s=f.iconRect(f.Icon.Right),u=new Float32Array([-1,-1,1,0,0,1,o.left,o.bottom,1,-1,1,0,0,1,o.left,o.top,1,1,1,0,0,1,o.right,o.top,-1,1,1,0,0,1,o.right,o.bottom,-1,-1,-1,0,0,-1,n.right,n.bottom,-1,1,-1,0,0,-1,n.left,n.bottom,1,1,-1,0,0,-1,n.left,n.top,1,-1,-1,0,0,-1,n.right,n.top,-1,1,-1,0,1,0,a.left,a.bottom,-1,1,1,0,1,0,a.left,a.top,1,1,1,0,1,0,a.right,a.top,1,1,-1,0,1,0,a.right,a.bottom,-1,-1,-1,0,-1,0,s.right,s.bottom,1,-1,-1,0,-1,0,s.left,s.bottom,1,-1,1,0,-1,0,s.left,s.top,-1,-1,1,0,-1,0,s.right,s.top,1,-1,-1,1,0,0,r.right,r.bottom,1,1,-1,1,0,0,r.left,r.bottom,1,1,1,1,0,0,r.left,r.top,1,-1,1,1,0,0,r.right,r.top,-1,-1,-1,-1,0,0,i.left,i.bottom,-1,-1,1,-1,0,0,i.left,i.top,-1,1,1,-1,0,0,i.right,i.top,-1,1,-1,-1,0,0,i.right,i.bottom]),l=new Uint8Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]);this.vao.loadData(u,l),this.renderState.depthTest=!1,this.renderState.depthWrite=!1,this.u_wvp=e.getUniformLocation(this.program,"u_worldViewProjection"),this.u_worldInverseTranspose=e.getUniformLocation(this.program,"u_worldInverseTranspose"),this.u_lightPos=e.getUniformLocation(this.program,"u_lightPos"),this.u_texture=e.getUniformLocation(this.program,"u_texture"),this.texture=t.iconsTexture}e.Axis=g;var b=(_.prototype.render=function(t){if(0!=t.downloadingTasks){var e=this.gl;e.viewport(10,10,32,32),e.useProgram(this.program),t.setRenderState(this.rs);var r=d.matIdentity();e.uniformMatrix4fv(this.u_transform,!1,r);var i=+new Date/1e3-1567070764;e.uniform1f(this.u_time,i),this.vao.bind(),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_BYTE,0),t.invalidate()}},_.prototype.dispose=function(){this.gl.deleteProgram(this.program),this.vao.dispose()},_);function _(t){var e=t.gl;this.gl=e;var r=new Float32Array([-1,-1,1,-1,1,1,-1,1]),i=new Uint8Array([0,1,2,0,2,3]);this.vao=new p.VertexArrayObject(e,[2]),this.vao.loadData(r,i),this.program=t.createShader(c.VertexShaders.Overlay,c.FragmentShaders.Indicator),this.u_time=e.getUniformLocation(this.program,"u_time"),this.u_transform=e.getUniformLocation(this.program,"u_transform"),this.rs=new h.RenderState,this.rs.depthTest=!1,this.rs.depthWrite=!1}e.LoadingIndicator=b},function(t,e,r){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var n,a=r(1),p=r(4),s=(n=a.Renderable,o(u,n),u.prototype.render=function(t,e){if(this.visible){this.gl=t.gl;var r=this.gl;this.vao||this.build(t),t.variables.setWorld(e.worldTransform),this.material.applyUniforms(t),this.vao.bind(),this.vao.hasIndice?r.drawElements(this.topology,this.indiceCount,this.indiceType,0):r.drawArrays(this.topology,0,this.controlPointCount)}},u.prototype.dispose=function(){this.vao&&this.vao.dispose(),this.vao=null},u.prototype.createGeometry=function(t,e,r,i,o){void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null);var n=this.gl;this.topology=t,this.controlPointCount=e.length/3;var a=e.length;r&&(a+=r.length),i&&(a+=i.length);var s,u=new Float32Array(a),l=0;u.set(e,0),l+=e.length,r&&(u.set(r,l),l+=r.length),i&&(u.set(i,l),l+=i.length),null!=o&&(this.indiceCount=o.length,this.indiceCount<256?(s=new Int8Array(o),this.indiceType=n.UNSIGNED_BYTE):this.indiceCount<65536?(s=new Int16Array(o),this.indiceType=n.UNSIGNED_SHORT):(s=new Int32Array(o),this.indiceType=n.UNSIGNED_INT));var c=this.material.descriptor.program,h=[{location:n.getAttribLocation(c,"a_position"),size:3,type:n.FLOAT}];if(r&&-1!=d){var d=n.getAttribLocation(c,"a_normal");-1!=d&&h.push({size:3,type:n.FLOAT,location:d})}if(i){var f=n.getAttribLocation(c,"a_texcoord");-1!=f&&h.push({size:2,type:n.FLOAT,location:f})}this.vao=new p.VertexArrayObject(n,h),this.vao.loadData(u,s)},u);function u(){var t=null!==n&&n.apply(this,arguments)||this;return t.indiceCount=0,t.indiceType=0,t.controlPointCount=0,t}e.Primitive=s},function(t,e,r){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var s,n,a=r(3),u=r(2),l=r(0),c=r(4);(n=s=e.Icon||(e.Icon={}))[n.Front=0]="Front",n[n.Back=1]="Back",n[n.Top=2]="Top",n[n.Bottom=3]="Bottom",n[n.Left=4]="Left",n[n.Right=5]="Right",n[n.Wireframe=6]="Wireframe",n[n.Solid=7]="Solid",n[n.Move=8]="Move",n[n.Rotate=9]="Rotate",n[n.Settings=10]="Settings";var h=.25;function m(t){var e=t%4*h,r=(t>>2)*h;return{top:r,bottom:r+h,left:e+h,right:e}}e.iconRect=m;var d,A=(o(f,d=function(){this.visible=!0}),f);function f(t,e,r,i,o){void 0===i&&(i=32),void 0===o&&(o=32);var n=d.call(this)||this;return n.checked=!1,n.x=e,n.y=r,n.w=i,n.h=o,n.icon=t,n}var p=(v.prototype.dispose=function(){this.vao.dispose()},v.prototype.update=function(){for(var t=this.widgets,a=new Float32Array(8*t.length*4),e=new Int16Array(6*t.length),s=0,r=0,i=function(t,e,r,i,o){var n=s;s+=8,a[n+0]=t,a[n+1]=e,a[n+2]=r,a[n+3]=i,a[n+4]=o[0],a[n+5]=o[1],a[n+6]=o[2],a[n+7]=1},o=function(t){return[(t>>16)/255,(t>>8&255)/255,(255&t)/255]},n=o(1710618),u=o(3158064),l=o(4361162),c=0;c<t.length;c++){var h=t[c];if(h.visible&&h instanceof A){var d=h,f=this.hoveredWidget==h?u:d.checked?l:n,p=m(h.icon);i(h.x,h.y,p.right,p.top,f),i(h.x+h.w,h.y,p.left,p.top,f),i(h.x+h.w,h.y+h.h,p.left,p.bottom,f),i(h.x,h.y+h.h,p.right,p.bottom,f);var v=4*c;e[r+0]=3+v,e[r+1]=1+v,e[r+2]=0+v,e[r+3]=3+v,e[r+4]=2+v,e[r+5]=1+v,r+=6}}this.numIndices=e.length,this.vao.loadData(a,e)},v.prototype.render=function(t,e){if(this.visible){var r=l.matIdentity(),i=this.renderer.size[0],o=this.renderer.size[1];r[0]=2/i,r[5]=-2/o,r[12]=-1,r[13]=1;var n=this.renderer.gl;n.useProgram(this.program),n.uniformMatrix4fv(this.u_transform,!1,r),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,t.iconsTexture.texture),n.uniform1i(this.u_icons,0),this.vao.bind(),n.drawElements(n.TRIANGLES,this.numIndices,n.UNSIGNED_SHORT,0)}},v.prototype.mousemove=function(t){var e=this.hitTest(t.x,t.y);e!=this.hoveredWidget&&(this.hoveredWidget=e,this.renderer.invalidate())},v.prototype.mousedown=function(t){this.hoveredWidget=this.hitTest(t.x,t.y)},v.prototype.mouseup=function(t){this.hoveredWidget=this.hitTest(t.x,t.y),this.hoveredWidget&&this.hoveredWidget.onclick&&(this.hoveredWidget.onclick(t),this.renderer.invalidate())},v.prototype.hitTest=function(t,e){for(var r,i,o,n=0,a=this.widgets;n<a.length;n++){var s=a[n];if(i=t,o=e,(r=s).visible&&i>r.x&&i<r.x+r.w&&o>r.y&&o<r.y+r.h)return s}return null},v);function v(t){this.widgets=[],this.visible=!0;var e=(this.renderer=t).canvas;e.addEventListener("mousedown",this.mousedown.bind(this)),e.addEventListener("mouseup",this.mouseup.bind(this)),e.addEventListener("mousemove",this.mousemove.bind(this));var r=t.gl;this.vao=new c.VertexArrayObject(r,[2,2,4]),this.program=t.createShader(a.VertexShaders.Overlay,a.FragmentShaders.Overlay),this.u_transform=r.getUniformLocation(this.program,"u_transform"),this.u_icons=r.getUniformLocation(this.program,"u_icons"),this.rs=new u.RenderState,this.rs.depthTest=!1,this.initUI(),this.update()}var g,y=(o(b,g=p),b.prototype.initUI=function(){var o=10,n=this.widgets;function t(t,e,r){var i=new A(t,o,10);return i.visible=e,i.onclick=r.bind(a,i),o+=i.w,n.push(i),i}this.menu=[];var e=this.menu,a=this;t(s.Settings,!0,this.onSettingClicked),e.push(this.movable=t(s.Move,!1,this.onMoveClicked)),e.push(this.wireframe=t(s.Wireframe,!1,this.onWireframeClicked)),e.push(this.solid=t(s.Solid,!1,this.onSolidClicked)),this.movable.checked=!0,this.solid.checked=!0},b.prototype.canMove=function(){return this.movable.checked},b.prototype.onSettingClicked=function(t,e){for(var r=0,i=this.menu;r<i.length;r++){var o=i[r];o.visible=!o.visible}this.update()},b.prototype.onMoveClicked=function(t,e){t.checked=!t.checked},b.prototype.onRotateClicked=function(t,e){t.checked=!t.checked},b.prototype.onWireframeClicked=function(t,e){t.checked=!t.checked,this.renderer.showWireframe=t.checked},b.prototype.onSolidClicked=function(t,e){t.checked=!t.checked,this.renderer.showSolid=t.checked},b);function b(){return null!==g&&g.apply(this,arguments)||this}e.GUI=y},function(t,e,r){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),a=(s.prototype.render=function(t){var e=this.gl;if(!t.showSolid&&this.hasWireframe||(this.material.applyUniforms(t),this.vao.bind(),this.vao.hasIndice?e.drawElements(this.primitiveMode,this.indiceCount,this.indexType,this.offset):e.drawArrays(this.primitiveMode,0,this.numControlPoints)),t.showWireframe&&this.hasWireframe&&this.vao.hasIndice){t.wireframeMaterial.applyUniforms(t),this.vao.bind();var r=0;switch(this.indexType){case 5121:r=1;break;case 5123:r=2;break;case 5125:r=4}e.drawElements(e.LINES,2*this.indiceCount,this.indexType,r*this.indiceCount)}},s.prototype.dispose=function(){this.vao.dispose(),this.vao=null},s);function s(t,e,r,i,o,n,a,s){this.hasWireframe=!0,this.offset=0,this.gl=t,this.primitiveMode=e,this.vao=r,this.numControlPoints=i.length/3,this.indexType=o,this.indiceCount=a,this.material=s,this.controlPoints=i,this.offset=n}e.SubMesh=a;var u,l=(u=n.Renderable,o(c,u),c.prototype.render=function(e,r){e.variables.setWorld(r.worldTransform);for(var t=function(t){if(!t.material||1==t.material.transparency)return"continue";0==t.material.transparency?t.render(e):e.renderPostoned(function(){e.variables.setWorld(r.worldTransform),t.render(e)})},i=0,o=this.subMeshes;i<o.length;i++)t(o[i])},c.prototype.dispose=function(){for(var t=0,e=this.subMeshes;t<e.length;t++)e[t].dispose();this.subMeshes.splice(0)},c);function c(){var t=null!==u&&u.apply(this,arguments)||this;return t.subMeshes=[],t}e.Mesh=l},function(t,e,r){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),h=r(7),a=(s.prototype.apply=function(t){},s.prototype.update=function(){},s.prototype.wheel=function(t){},s.prototype.mousemove=function(t){},s);function s(){}e.Movement=a;var u,l=(o(c,u=a),c.prototype.apply=function(t){(this.r=t).animationMode=!0},c.prototype.wheel=function(t){this.elevation=Math.max(0,Math.min(1,(.05*Math.sign(t.deltaY)+1)*this.elevation))},c.prototype.mousemove=function(t){1==t.buttons&&(this.lng+=-.01*t.movementX,this.lat+=.01*t.movementY,this.direction=Math.sign(-t.movementX))},c.prototype.update=function(){this.lng+=this.r.deltaTime*this.direction*1e-4;var t=this.lat,e=this.lng,r=this.r.camera,i=this.elevation*(this.maximumDistance-this.minimumDistance)+this.minimumDistance,o=this.target,n=i*Math.cos(t)*Math.cos(e),a=-i*Math.sin(t),s=-i*Math.cos(t)*Math.sin(e),u=o[0]-n,l=o[1]-a,c=o[2]-s;r.node.setLocalTransform(h.matTranslate(u,l,c)),r.setDirection([n,a,s])},c);function c(){var t=null!==u&&u.apply(this,arguments)||this;return t.elevation=.5,t.lat=.4,t.lng=0,t.direction=1,t.minimumDistance=1,t.maximumDistance=100,t.target=[0,0,0],t}e.OrbitalMovement=l;var d,f=(o(p,d=a),p.prototype.apply=function(t){var e=t.camera;this.camera=e,this.r=t;var r=e.node.localTransform;this.cameraPos=[r[12],r[13],r[14]],this.direction=e.direction,this.up=[e.up[0],e.up[1],e.up[2]]},p.prototype.wheel=function(t){n.vec3Cross(this.left,this.direction,this.camera.up);var e=-.01*t.deltaY;n.vec3AddMul(this.cameraPos,this.cameraPos,this.direction,e),this.camera.node.setLocalTransform(h.matTranslate(this.cameraPos[0],this.cameraPos[1],this.cameraPos[2])),this.r.invalidate()},p.prototype.mousemove=function(t){if(1==t.buttons){n.vec3Cross(this.left,this.direction,this.camera.up),n.vec3Cross(this.up,this.left,this.direction);var e=.001*t.movementX,r=-.001*t.movementY;n.quatFromAngleAxis(this.q1,e,this.up),n.quatFromAngleAxis(this.q2,-r,this.left),n.quatConcat(this.q,this.q1,this.q2),n.quatMul(this.direction,this.q,this.direction),this.camera.setDirection(this.direction),this.r.invalidate()}else 4==t.buttons&&this.onWheel(t.movementX,t.movementY,!0)},p.prototype.onWheel=function(t,e,r){n.vec3Cross(this.left,this.direction,this.camera.up);var i=-.01*t,o=.01*e;n.vec3AddMul(this.cameraPos,this.cameraPos,this.up,o),n.vec3AddMul(this.cameraPos,this.cameraPos,this.left,i),this.camera.node.setLocalTransform(h.matTranslate(this.cameraPos[0],this.cameraPos[1],this.cameraPos[2])),this.camera.setDirection(this.direction),this.r.invalidate()},p);function p(){var t=null!==d&&d.apply(this,arguments)||this;return t.left=[0,0,0],t.q1=[0,0,0,1],t.q2=[0,0,0,1],t.q=[0,0,0,1],t}e.StandardMovement=f},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var g=r(7),y=r(0);window.aspose3d=function(m){var t=document.getElementById(m.canvas);if(t)if("http:"==location.protocol||"https:"==location.protocol){var A=new g.A3DRenderer(t);"ui"in m&&(A.ui.visible=!!m.ui),"orientationBox"in m&&(A.axis.visible=!!m.orientationBox);var e=new g.A3DWLoader(A);if(m.url)e.load(m.url).then(r);else r(new g.SceneNode)}else g.A3DRenderer.showError(t,"URL scheme must be http or https for CORS request.");else console.info("Cannot find specified canvas.");function r(t){var e=new g.Camera,r=t.createChildNode(e),i=function(t,e){var r="z",i=.1,o=100,n=45,a=[0,0,0],s=[10,10,10];switch(e&&("near"in e&&(i=e.near),"far"in e&&(o=e.far),"fov"in e&&(n=e.fov),"lookAt"in e&&e.lookAt instanceof Array&&(a=e.lookAt),"position"in e&&e.position instanceof Array&&(s=e.position),r=e.up),t.near=i,t.far=o,t.fov=n,r){case"x":t.up=[1,0,0];break;case"y":t.up=[0,1,0];break;case"z":t.up=[0,0,1];break;default:t.up=[0,0,1],r="z"}return t.node.setLocalTransform(g.matTranslate(s[0],s[1],s[2])),t.lookAt(a[0],a[1],a[2]),r}(e,m.camera),o=g.calculateBoundingBox(t);if(m.centerModel){var n=[0,0,0];y.vec3Mul(n,e.up,o.min),y.vec3Mul(n,n,-1);for(var a=0,s=t.children;a<s.length;a++){var u=s[a];if(u!=r){var l=u.localTransform;l[12]+=n[0],l[13]+=n[1],l[14]+=n[2],u.setLocalTransform(l)}}y.vec3Add(o.min,o.min,n),y.vec3Add(o.max,o.max,n)}"ruler"in m&&(A.ruler.visible=!!m.ruler,A.ruler.setBoundingBox(o));var c=new g.Light;c.type=g.LightType.Directional,c.setDirection([0,-.3,-.4]);var h=t.createChildNode(c);h.setLocalTransform(g.matTranslate(10,3,3)),(c=new g.Light).type=g.LightType.Omni,c.lookAt(0,0,0),r.createChildNode(c);var d=new g.Grid(i);switch("grid"in m&&(d.visible=m.grid),t.createChildNode(d),A.light=h.entity,A.setCamera(r.entity),A.invalidate(),m.movement||"standard"){case"orbital":var f=A.movement=new g.OrbitalMovement;f.target=[.5*(o.max[0]+o.min[0]),.5*(o.max[1]+o.min[1]),.5*(o.max[2]+o.min[2])];var p=[0,0,0];y.vec3Sub(p,o.max,o.min);var v=2*y.vec3Length(p);f.maximumDistance=v;break;default:A.movement=new g.StandardMovement}m.onload&&setTimeout(m.onload.bind(null,t),0)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r(5),o=r(1),i=r(2),n=r(0),s=r(19),u=r(20),l=r(3),c=r(9),h=r(6),d=r(11),f=r(21),p=r(22),v=(Object.defineProperty(m.prototype,"animationMode",{get:function(){return this._animationMode},set:function(t){(this._animationMode=t)&&this.invalidateImpl()},enumerable:!0,configurable:!0}),m.prototype.showUnsupported=function(){m.showError(this.canvas,"WebGL2 is not supported by your browser.")},m.showError=function(t,e){m.updateSize(t);var r=t.getContext("2d");r.font="20px Georgia";var i=t.width,o=t.height;r.strokeStyle="#ff0000",r.lineWidth=20,r.beginPath(),r.moveTo(0,0),r.lineTo(i,o),r.moveTo(0,o),r.lineTo(i,0),r.closePath(),r.stroke(),r.fillText(e,0,.5*(o-50),i)},m.updateSize=function(t){var e=t.clientWidth,r=t.clientHeight;e==t.width&&r==t.height||(t.width=e,t.height=r)},m.prototype.dispose=function(){this.indicator.dispose(),this.ui.dispose(),this.axis.dispose(),this.variables.dispose(),this.whiteTex.dispose(),this.background.dispose();for(var t=this.gl,e=0,r=[this.phongMaterial,this.pbrMaterial,this.gridMaterial];e<r.length;e++){var i=r[e];t.deleteProgram(i.program)}},m.prototype.initMaterials=function(){this.phongMaterial=this.createMaterialDescriptor(i.PhongMaterialDescriptor,l.VertexShaders.StandardMaterial,l.FragmentShaders.Phong),this.pbrMaterial=this.createMaterialDescriptor(i.PbrMaterialDescriptor,l.VertexShaders.StandardMaterial,l.FragmentShaders.pbr),this.gridMaterial=this.createMaterialDescriptor(i.MaterialDescriptor,l.VertexShaders.GridVertex,l.FragmentShaders.GridFragment),this.wireframeMaterialDesc=this.createMaterialDescriptor(i.WireframeMaterialDescriptor,l.VertexShaders.StandardMaterial,l.FragmentShaders.Wireframe),this.wireframeMaterial=new i.WireframeMaterial(this.wireframeMaterialDesc),this.wireframeMaterial.renderState.depthFunction=i.CompareFunction.LEqual},m.prototype.createMaterialDescriptor=function(t,e,r){var i=new t,o=this.createShader(e,r);return i.loadUniforms(o,this),i},m.prototype.compileShader=function(t,e){var r=this.gl,i=r.createShader(e);if(r.shaderSource(i,t),r.compileShader(i),r.getShaderParameter(i,r.COMPILE_STATUS))return i;var o=r.getShaderInfoLog(i);return console.error("Failed to compile shader, error:"+o),r.deleteShader(i),0},Object.defineProperty(m.prototype,"movement",{get:function(){return this._movement},set:function(t){(this._movement=t)&&t.apply(this)},enumerable:!0,configurable:!0}),m.prototype.createShader=function(t,e){var r=this.gl,i=this.compileShader(t,r.VERTEX_SHADER);if(!i)return 0;var o=this.compileShader(e,r.FRAGMENT_SHADER);if(!o)return r.deleteShader(i),0;var n=r.createProgram();return r.attachShader(n,i),r.attachShader(n,o),r.linkProgram(n),r.deleteShader(i),r.deleteShader(o),r.getProgramParameter(n,r.LINK_STATUS)?n:(console.error("Failed to link shader program, error: "+r.getProgramInfoLog(n)),r.deleteProgram(n),0)},m.prototype.update=function(){var t=this.variables;if(t.updateLights(),this.light){var e=this.light;t.lightColor[0]=e.color[0],t.lightColor[1]=e.color[1],t.lightColor[2]=e.color[2];var r=e.node.worldTransform;t.lightWorldPos[0]=r[12],t.lightWorldPos[1]=r[13],t.lightWorldPos[2]=r[14]}else t.lightColor.fill(1,0,3),t.lightWorldPos.fill(0,0,3);var i=this.matIdentity,o=this.matIdentity;this.camera&&(this.camera.update(),i=this.camera.view,o=this.camera.projection),t.setViewProject(i,o),this.ui.update(),this._movement&&this._movement.update()},m.prototype.invalidate=function(){this._animationMode||this.invalidateImpl()},m.prototype.invalidateImpl=function(){this.invalidated=!0;var e=this;requestAnimationFrame(function(t){e.deltaTime=t-e.time,e.time=t,e.camera&&e.render(),e._animationMode&&e.invalidateImpl()})},m.prototype.render=function(){if(this.gl){if(m.updateSize(this.canvas),!this.camera)throw new Error("Cannot render the scene without a camera");this.invalidated=!1,this.update();var t=this.gl,e=this.canvas.clientWidth,r=this.canvas.clientHeight;if(t.viewport(0,0,e,r),t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT),this.background.render(this,null),this.rootNode&&(this.postonedQueue.length=0,this.renderNode(this.rootNode),0<this.postonedQueue.length))for(var i=0,o=this.postonedQueue;i<o.length;i++)(0,o[i])();for(var n=0,a=this.helpers;n<a.length;n++)a[n].render(this,null)}},m.prototype.renderPostoned=function(t){this.postonedQueue.push(t)},m.prototype.setCamera=function(t){if(!t.node)throw new Error("The camera must inside a scene");for(var e=t.node;e&&e.parent;e=e.parent);this.rootNode=e,this.camera=t;var o=[],n=function(t){t.entity instanceof a.Light&&o.push(t.entity);for(var e=0,r=t.children;e<r.length;e++){var i=r[e];n(i)}};n(e),this.variables.setLights(o)},m.prototype.renderNode=function(t){t.entity instanceof o.Renderable&&t.entity.render(this,t);for(var e=0,r=t.children;e<r.length;e++){var i=r[e];this.renderNode(i)}},m.prototype.createMaterial=function(t){switch(t){case"phong":case"lambert":return new i.PhongMaterial(this.phongMaterial);case"grid":return new i.Material(this.gridMaterial);case"wireframe":return new i.WireframeMaterial(this.wireframeMaterialDesc);case"pbr":return new i.PbrMaterial(this.pbrMaterial);default:throw new Error("Invalid shading model "+t)}},m.prototype.setCap=function(t,e){e?this.gl.enable(t):this.gl.disable(t)},m.prototype.setRenderState=function(t){var e=this.currentState,r=this.gl;if(e.depthWrite!=t.depthWrite&&(r.depthMask(t.depthWrite),e.depthWrite=t.depthWrite),e.cullFace!=t.cullFace&&(this.setCap(r.CULL_FACE,t.cullFace),e.cullFace=t.cullFace),e.depthTest!=t.depthTest&&(this.setCap(r.DEPTH_TEST,t.depthTest),e.depthTest=t.depthTest),e.depthFunction!=t.depthFunction){var i=this.translateCompareFunction(t.depthFunction);r.depthFunc(i),e.depthFunction=t.depthFunction}e.blend!=t.blend&&(this.setCap(r.BLEND,t.blend),e.blend=t.blend),e.sourceBlendFactor==t.sourceBlendFactor&&e.destinationBlendFactor==t.destinationBlendFactor||(r.blendFunc(t.sourceBlendFactor,t.destinationBlendFactor),e.sourceBlendFactor=t.sourceBlendFactor,e.destinationBlendFactor=t.destinationBlendFactor)},m.prototype.translateCompareFunction=function(t){switch(t){case i.CompareFunction.Always:return this.gl.ALWAYS;case i.CompareFunction.Equal:return this.gl.EQUAL;case i.CompareFunction.GEqual:return this.gl.GEQUAL;case i.CompareFunction.Greater:return this.gl.GREATER;case i.CompareFunction.LEqual:return this.gl.LEQUAL;case i.CompareFunction.Less:return this.gl.LESS;case i.CompareFunction.Never:return this.gl.NEVER;case i.CompareFunction.NotEqual:return this.gl.NOTEQUAL;default:return t}},m);function m(t){this.size=[0,0],this.downloadingTasks=0,this.showSolid=!0,this.showWireframe=!1,this.invalidated=!0,this.matIdentity=n.matIdentity(),this.currentState=new i.RenderState,this.postonedQueue=[],this.helpers=[],this._animationMode=!0,this.time=+new Date,this.deltaTime=0;var e=t.getContext("webgl2",{depth:!0,alpha:!0});if(this.canvas=t,m.updateSize(t),this.size[0]=t.width,this.size[1]=t.height,e){this.gl=e,this.ui=new d.GUI(this),this.background=new s.default(this,[.3,.3,.3],[.1,.1,.1]),this.indicator=new c.LoadingIndicator(this),this.initMaterials(),this.whiteTex=new h.TextureUnit(this),this.whiteTex.loadFromPixels(255,255,255,255),this.iconsTexture=new h.TextureUnit(this),this.iconsTexture.load(l.Assets.Icons),this.variables=new u.default(this),this.axis=new c.Axis(this),this.font=new f.Font(this),this.ruler=new p.RulerRenderer(this),this.helpers.push(this.ruler,this.ui,this.axis,this.indicator),e.enable(e.CULL_FACE),e.enable(e.DEPTH_TEST),e.clearColor(0,1,0,1),e.clearDepth(1),e.depthFunc(e.LEQUAL),e.blendEquation(e.FUNC_ADD);var r=this;t.addEventListener("wheel",function(t){r.ui.canMove()&&r._movement&&r._movement.wheel(t)}),t.addEventListener("mousemove",function(t){r.ui.canMove()&&r._movement&&r._movement.mousemove(t)})}else this.showUnsupported()}e.A3DRenderer=v},function(t,e){var r,i,o=t.exports={};function n(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===n||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:n}catch(t){r=n}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}}();var u,l=[],c=!1,h=-1;function d(){c&&u&&(c=!1,u.length?l=u.concat(l):h=-1,l.length&&f())}function f(){if(!c){var t=s(d);c=!0;for(var e=l.length;e;){for(u=l,l=[];++h<e;)u&&u[h].run();h=-1,e=l.length}u=null,c=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];l.push(new p(t,e)),1!==l.length||c||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;function r(){}r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(2),a=r(3),s=r(4),i=(o.prototype.dispose=function(){this.gl.deleteProgram(this.program),this.vao.dispose()},o.prototype.render=function(t,e){var r=this.gl;r.useProgram(this.program),t.setRenderState(this.renderState),r.uniform1f(this.height,r.canvas.height),r.uniform4f(this.lowerLoc,this.lower[0],this.lower[1],this.lower[2],1),r.uniform4f(this.upperLoc,this.upper[0],this.upper[1],this.upper[2],1),this.vao.bind(),r.drawArrays(r.TRIANGLES,0,6)},o);function o(t,e,r){this.renderState=new n.RenderState,this.upper=e,this.lower=r;var i=this.gl=t.gl;this.renderState.depthTest=!1,this.renderState.depthWrite=!1,this.program=t.createShader(a.VertexShaders.BackgroundVertex,a.FragmentShaders.BackgroundFragment),this.height=i.getUniformLocation(this.program,"height"),this.lowerLoc=i.getUniformLocation(this.program,"lower"),this.upperLoc=i.getUniformLocation(this.program,"upper");var o=new s.VertexArrayObject(i,[2]);(this.vao=o).loadData(new Float32Array([-1,-1,1,1,-1,1,1,1,-1,-1,1,-1]))}e.default=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var d=r(0),f=r(5),i=(o.prototype.dispose=function(){this.gl.deleteBuffer(this.lightBuffer)},o.prototype.setViewProject=function(t,e){this.view.set(t),this.project.set(e),d.matInvert_(this.viewInverse,t),d.matMul_(this.viewProjection,e,t)},o.prototype.setWorld=function(t){this.world.set(t),d.matMul_(this.worldViewProjection,this.viewProjection,t),d.matInvert_(this.worldInverse,t),d.matTranspose_(this.worldInverseTranspose,this.worldInverse)},o.prototype.setLights=function(t){this.lights=t},o.prototype.updateLights=function(){for(var t=this.lights,e=this.gl,r=new Float32Array(160),i=0,o=0,n=t;o<n.length;o++){var a=n[o];a.update();var s=a.node.worldTransform,u=1,l=-1,c=0;a.type==f.LightType.Directional?u=0:a.type==f.LightType.Spot?(u=1,l=Math.cos(d.toRadian(a.falloff)),c=a.falloff>a.hotSpot?Math.log10(1-(a.falloff-a.hotSpot)/a.falloff)/l:1):u=1,r[i++]=s[12],r[i++]=s[13],r[i++]=s[14],r[i++]=u,r[i++]=l;var h=a.view;r[i++]=-h[2],r[i++]=-h[6],r[i++]=-h[10],r[i++]=a.constantAttenuation,r[i++]=a.linearAttenuation,r[i++]=a.quadraticAttenuation,r[i++]=c,r[i++]=a.color[0],r[i++]=a.color[1],r[i++]=a.color[2],r[i++]=a.color[3]}e.bindBuffer(e.UNIFORM_BUFFER,this.lightBuffer),e.bufferData(e.UNIFORM_BUFFER,r,e.DYNAMIC_DRAW)},o);function o(t){this.lightColor=new Float32Array(3),this.lightWorldPos=new Float32Array(3),this.worldViewProjection=new Float32Array(16),this.viewProjection=new Float32Array(16),this.world=new Float32Array(16),this.view=new Float32Array(16),this.project=new Float32Array(16),this.worldView=new Float32Array(16),this.viewInverse=new Float32Array(16),this.worldInverse=new Float32Array(16),this.worldInverseTranspose=new Float32Array(16),this.identity=d.matIdentity(),this.lights=[];var e=t.gl;this.gl=e,this.lightBuffer=e.createBuffer()}e.default=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var u=r(6),l=r(3),i=(o.prototype.dispose=function(){this.gl},o);function o(t){this.chars={},this.fontTex=new u.TextureUnit(t),this.fontTex.load(l.Assets.Fonts);var e=t.gl;this.gl=e;for(var r=16/l.Assets.FontSize[0],i=20/l.Assets.FontSize[1],o=~~(l.Assets.FontSize[0]/16),n=0;n<l.Assets.Alphabet.length;n++){var a=l.Assets.Alphabet.charAt(n),s={left:n%o*r,top:~~(n/o)*i,width:r,height:i};this.chars[a]=s}this.chars[" "]={left:0,top:0,width:0,height:0}}e.Font=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(4),P=r(0),o=r(2),n=r(3),a=(s.prototype.setBoundingBox=function(t){var e=t.min,r=t.max;if(e&&r){for(var i=0;i<3;i++){var o=Math.abs(r[i]-e[i]);this.axises[i].text=this.formatLength(o)}this.min=e.slice(0),this.max=r.slice(0),this.buildLines(e,r),this.buildLabels()}else this.visible=!1},s.prototype.formatLength=function(t){return 1e3<t?(t/1e3+.005).toFixed(2)+"km":0==t?"0m":t<1?(100*t+.005).toFixed(2)+"cm":t<.01?(1e3*t+.005).toFixed(2)+"mm":(t+.005).toFixed(2)+"m"},s.prototype.buildLines=function(a,s){function u(t,e){r.push(t[0]+.01),r.push(t[1]+.01),r.push(t[2]+.01),r.push(e[0]+.01),r.push(e[1]+.01),r.push(e[2]+.01)}function l(t,e,r,i){var o=r.slice(0),n=[0,0,0,0],a=[0,0,0];P.vec3Normalize(o),P.quatFromAngleAxis(n,Math.PI/6,t),P.quatMul(a,n,o),P.vec3AddMul(a,e,a,.1*i),u(e,a),P.quatFromAngleAxis(n,-Math.PI/6,t),P.quatMul(a,n,o),P.vec3AddMul(a,e,a,.1*i),u(e,a),P.vec3Mul(a,o,i),P.vec3Add(a,a,e),u(e,a),P.vec3Cross(o,t,o);var s=[0,0,0];P.vec3AddMul(a,e,o,.1*i),P.vec3AddMul(s,e,o,-.1*i),u(s,a)}function t(t){var e=c.axises[t].up,r=a,i=a.slice(0);i[t]=s[t];var o=[0,0,0];P.vec3Sub(o,i,r);var n=P.vec3Length(o);l(e,r,o,.3*n),P.vec3Mul(o,o,-1),l(e,i,o,.3*n)}var c=this,r=[];t(0),t(1),t(2),this.lines.loadData(new Float32Array(r)),this.lineVertices=r.length/3},s.prototype.buildLabels=function(){for(var t=0,e=0,r=this.axises;e<r.length;e++)t+=(h=r[e]).text.length;for(var o=0,n=0,a=new Float32Array(4*t*5),s=new Int16Array(6*t),u=this.font,l=function(t,e,r){var i=5*n;a[i++]=t[0],a[i++]=t[1],a[i++]=t[2],a[i++]=e,a[i++]=r,n++},i=0,c=this.axises;i<c.length;i++){var h,d=(h=c[i]).id,f=h.text,p=h.up,v=[0,0,0],m=[0,0,0],A=[0,0,0];A[d]=1;var g=Math.abs(this.max[d]-this.min[d]),y=.3*g,b=.4*g/f.length,_=b/.8;P.vec3AddMul(m,this.min,A,y);var w=[0,0,0],x=[0,0,0],T=[0,0,0],E=[0,0,0,0];P.quatFromAngleAxis(E,.5*Math.PI,p),P.quatMul(v,E,A),P.vec3Normalize(v),P.vec3Mul(v,v,_),P.vec3AddMul(m,m,v,-.5),P.vec3Normalize(A),P.vec3Mul(A,A,b);for(var S=function(t){var e=6*o,r=4*o;o++;var i=u.chars[t]||u.chars[" "];P.vec3Add(w,m,A),P.vec3Add(T,m,v),P.vec3Add(x,T,A),l(m,i.left,i.top+i.height),l(w,i.left+i.width,i.top+i.height),l(x,i.left+i.width,i.top),l(T,i.left,i.top),s[0+e]=0+r,s[1+e]=1+r,s[2+e]=2+r,s[3+e]=0+r,s[4+e]=2+r,s[5+e]=3+r,m[0]=w[0],m[1]=w[1],m[2]=w[2]},L=0;L<f.length;L++)S(f.charAt(L))}this.text.loadData(a,s),this.numIndices=s.length},s.prototype.render=function(t,e){if(this.visible){var r=t.gl;r.useProgram(this.program),t.variables.setWorld(this.world),t.setRenderState(this.rs),r.uniformMatrix4fv(this.u_vp,!1,t.variables.viewProjection),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.font.fontTex.texture),r.uniform1i(this.u_tex,0),this.text.bind(),r.drawElements(r.TRIANGLES,this.numIndices,r.UNSIGNED_SHORT,0),this.lineMat.applyUniforms(t),this.lines.bind(),r.drawArrays(r.LINES,0,this.lineVertices)}},s.prototype.dispose=function(){this.text.dispose(),this.lines.dispose()},s);function s(t){this.visible=!1,this.axises=[],this.min=[],this.max=[];var e=t.gl;this.text=new i.VertexArrayObject(e,[3,2]),this.lines=new i.VertexArrayObject(e,[3]),this.font=t.font,this.world=P.matIdentity(),this.rs=new o.RenderState,this.rs.depthWrite=!1,this.rs.blend=!0,this.rs.cullFace=!1,this.rs.sourceBlendFactor=e.SRC_ALPHA,this.rs.destinationBlendFactor=e.DST_ALPHA,this.lineMat=t.createMaterial("grid"),this.program=t.createShader(n.VertexShaders.Text,n.FragmentShaders.Text),this.u_vp=e.getUniformLocation(this.program,"u_vp"),this.u_tex=e.getUniformLocation(this.program,"u_tex"),this.axises=[{id:0,text:"040cm",up:[0,1,0],origin:[0,0,0]},{id:1,text:"140cm",up:[0,0,1],origin:[0,0,0]},{id:2,text:"240cm",up:[0,1,0],origin:[0,0,0]}],this.setBoundingBox({min:null,max:null})}e.RulerRenderer=a},function(t,e,r){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var n,a=r(10),s=(n=a.Primitive,o(u,n),u.prototype.build=function(t){n.prototype.createGeometry.call(this,this.gl.TRIANGLES,[0,1,0,1,1,0,1,0,0,0,0,0],[0,0,1,0,0,1,0,0,1,0,0,1],[0,1,1,1,1,0,0,0],[0,1,3,3,1,2])},u);function u(){return null!==n&&n.apply(this,arguments)||this}e.Plane=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var m=r(12),A=r(0),g=r(8);e.calculateBoundingBox=function(d){var f=null,p=null,v=function(t){if(t.entity instanceof m.Mesh)for(var e=d.worldTransform,r=[0,0,0,1],i=0,o=t.entity.subMeshes;i<o.length;i++)for(var n=o[i].controlPoints,a=0;a<n.length;a+=3)if(r[0]=n[a],r[1]=n[a+1],r[2]=n[a+2],A.matTransform_(r,r,e),g.isNull(f))f=r.slice(0),p=r.slice(0);else for(var s=0;s<3;s++){var u=r[s];u<f[s]?f[s]=u:u>p[s]&&(p[s]=u)}if(t.children&&0<t.children.length)for(var l=0,c=t.children;l<c.length;l++){var h=c[l];v(h)}};return v(d),{min:f,max:p}}},function(t,e,r){"use strict";var i=this&&this.__awaiter||function(n,a,s,u){return new(s=s||Promise)(function(t,e){function r(t){try{o(u.next(t))}catch(t){e(t)}}function i(t){try{o(u.throw(t))}catch(t){e(t)}}function o(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(r,i)}o((u=u.apply(n,a||[])).next())})},d=this&&this.__generator||function(r,i){var o,n,a,t,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(a=2&e[0]?n.return:e[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,e[1])).done)return a;switch(n=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,n=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){s.label=e[1];break}if(6===e[0]&&s.label<a[1]){s.label=a[1],a=e;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(e);break}a[2]&&s.ops.pop(),s.trys.pop();continue}e=i.call(r,s)}catch(t){e=[6,t],n=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var f=r(6),h=r(1),p=r(26),n=r(7),S=r(12),o=r(5),L=r(4),a=(s.prototype.load=function(h){return i(this,void 0,void 0,function(){var e,r,i,o,n,a,s,u,l,c;return d(this,function(t){switch(t.label){case 0:return[4,fetch(h).then(function(t){return t.arrayBuffer()})];case 1:if(e=t.sent(),r=new p.default(e),1464087361!=(this.reader=r).readUInt32())throw Error("The file is not a valid A3DW file.");if(17<r.readUInt8())throw Error("Unsupported version of A3DW file.");for(this.key=r.readBytes(8),r.readLEB128(),i=this.chunks;!r.eof;){if(o=r.ptr,n=r.readUInt8(),a=r.readUInt32(),s=o,5==n)for(u=new Uint8Array(r.buffer),l=this.key,c=0;c<a;c++,s++)u[s]^=l[7&c];r.ptr=o+a,i[n]=o+5}return this.readChunk(5),this.readStringPool(),this.readChunk(3)&&this.readTextures(),this.readChunk(2)&&this.readMaterials(),this.readChunk(6)&&this.readEntities(),this.readChunk(4)&&this.readOverlay(),this.readChunk(1),[2,this.readNodes()]}})})},s.prototype.readChunk=function(t){var e=this.chunks[t];return this.reader.ptr=e||0,0!=e},s.prototype.readTextures=function(){for(var t=this.reader,e=t.readLEB128(),r=0;r<e;r++){var i=t.readLEB128(),o=(t.readUInt8(),t.readUInt8(),t.readUInt8(),t.readUInt8(),t.readUInt8(),[0,0]),n=[0,0],a=[1,1];if(8&i&&(n[0]=t.readFloat32(),n[1]=t.readFloat32()),2&i&&(o[0]=t.readFloat32(),o[1]=t.readFloat32()),4&i&&(a[0]=t.readFloat32(),a[1]=t.readFloat32()),32&i){var s=t.readLEB128(),u=t.readBytes(s);this.decrypt(u);var l=URL.createObjectURL(new Blob([u]));(c=new f.TextureUnit(this.renderer)).load(l),c.ondispose=function(){URL.revokeObjectURL(this.url)},this.textures.push(c)}else{var c,h=t.readString();(c=new f.TextureUnit(this.renderer)).load(h),this.textures.push(c)}}},s.prototype.decrypt=function(t){for(var e=this.key,r=Math.min(8,t.length),i=0;i<r;i++)t[i]^=e[i]},s.prototype.readMaterials=function(){for(var t=this.reader,e=t.readLEB128(),r=0;r<e;r++){var i=t.readLEB128(),o=3&i;3==o?this.readPbrMaterial(i):this.readPhongLambertMaterial(o,i)}},s.prototype.readPhongLambertMaterial=function(t,e){var r,i=this.reader,o=this.renderer.createMaterial(2==t?"phong":"lambert");if(o.ambient=i.readVector3(),o.diffuse=i.readVector3(),4&e&&(r=this.textures[i.readLEB128()])&&(o.diffuse=r),o.emissive=i.readVector3(),8&e&&(r=this.textures[i.readLEB128()])&&(o.emissive=r),o.transparency=i.readFloat32(),o.transparentColor=i.readVector3(),2==t?(o.shininess=i.readFloat32(),o.specularFactor=i.readFloat32(),o.specular=i.readVector3(),32&e&&i.readLEB128()):(o.specularFactor=0,o.shininess=1),16&e){var n=i.readLEB128();o.normal=this.textures[n]}1024&e&&this.readRenderState(o.renderState),this.materials.push(o)},s.prototype.readPbrMaterial=function(t){var e=this.reader,r=this.renderer.createMaterial("pbr");r.albedo=e.readVector3(),4&t&&(r.albedo=this.textures[e.readLEB128()]||r.albedo),r.emissive=e.readVector3(),8&t&&(r.emissive=this.textures[e.readLEB128()]||r.emissive),r.metallic=e.readFloat32(),r.roughness=e.readFloat32(),64&t&&(r.metallicRoughnessTexture=this.textures[e.readLEB128()]),r.occlusion=e.readFloat32(),128&t&&(r.occlusion=this.textures[e.readLEB128()]||r.occlusion),r.transparency=e.readFloat32(),32&t&&(r.specular=this.textures[e.readLEB128()]),16&t&&(r.normal=this.textures[e.readLEB128()]),1024&t&&this.readRenderState(r.renderState),r.lighting=0==(256&t),r.identityMVP=!!(512&t),this.materials.push(r)},s.prototype.readRenderState=function(t){var e=this.reader,r=e.readLEB128();t.depthTest=!!(1&r),t.depthWrite=!!(2&r),t.blend=!!(4&r),t.depthTest&&(t.depthFunction=e.readLEB128()),t.blend&&(e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32(),t.sourceBlendFactor=e.readLEB128(),t.destinationBlendFactor=e.readLEB128())},s.prototype.readEntities=function(){for(var t=this.reader,e=t.readLEB128(),r=0;r<e;r++){var i=null;switch(t.readLEB128()){case 1:i=this.readLight();break;case 2:i=this.readCamera();break;case 0:i=this.readMesh();break;case 3:i=this.readLine();break;default:throw new Error("Unsupported entity type.")}this.entities.push(i)}},s.prototype.readLight=function(){var t=this.reader,e=new n.Light,r=t.readUInt8(),i=t.readUInt8();if(e.near=t.readFloat32(),e.far=t.readFloat32(),e.color=t.readVector3(),e.constantAttenuation=1,e.linearAttenuation=e.quadraticAttenuation=0,0!=i){var o=t.readVector3();e.setDirection(o)}return 2==i&&(e.falloff=t.readFloat32(),e.hotSpot=t.readFloat32()),e.intensity=t.readFloat32(),4&r&&(e.constantAttenuation=t.readFloat32()),16&r&&(e.linearAttenuation=t.readFloat32()),8&r&&(e.quadraticAttenuation=t.readFloat32()),e},s.prototype.readCamera=function(){var t=this.reader,e=new n.Camera,r=t.readLEB128(),i=t.readVector3();return e.setDirection(i),e.up=t.readVector3(),e.near=t.readFloat32(),e.far=t.readFloat32(),2&r?(e.fov=t.readFloat32(),e.projectionType=o.ProjectionType.Perspective):(e.projectionType=o.ProjectionType.Ortho,t.readFloat32(),t.readFloat32()),e},s.prototype.readLine=function(){for(var t=this.reader,e=t.readLEB128(),r=(t.readLEB128(),t.readLEB128()),i=this.materials[r],o=this.renderer.gl,n=t.readLEB128(),a=new Float32Array(3*n),s=0;s<3*n;s++)a[s]=t.readFloat32();var u=[],l=0;for(s=0;s<e;s++){var c=t.readLEB128();u.push(c),l+=2*(c-1)}var h=new Int16Array(l),d=0,f=new L.VertexArrayObject(o,[3]),p=new S.Mesh,v=null;i&&(v=this.renderer.createMaterial("wireframe"),"diffuse"in i&&(v.color=i.diffuse),v.renderState.depthWrite=!1,v.renderState.depthFunction=o.LEQUAL);for(s=0;s<e;s++){c=u[s];for(var m=d,A=t.readLEB128(),g=1;g<c;g++){var y=t.readLEB128();h[d++]=A,A=h[d++]=y}var b=new S.SubMesh(o,o.LINES,f,a,o.UNSIGNED_SHORT,m,2*(c-1),v);p.subMeshes.push(b)}return f.loadData(a,h),p},s.prototype.readMesh=function(){for(var t=new S.Mesh,e=this.reader.readLEB128(),r=0;r<e;r++){var i=this.readSubMesh();t.subMeshes.push(i)}return t},s.prototype.readSubMesh=function(){for(var t=this.reader,e=!(4&t.readLEB128()),r=t.readLEB128(),i=this.materials[r],o=0,n=t.readUInt8(),a=[],s=0,u=0;u<n;u++){var l=t.readUInt8(),c=t.readUInt8(),h=7&c;if(1!=c>>4||h<=0||4<=h)throw new Error("Unsupported attribute data type");0==l&&(s=o),a.push(h),o+=4*h}var d,f=this.renderer.gl,p=new L.VertexArrayObject(f,a),v=t.readLEB128(),m=t.readBytes(v),A=t.readLEB128(),g=0;if(65535<A){var y=t.readBytes(4*A);d=new Uint32Array(y.buffer,y.byteOffset,A),g=f.UNSIGNED_INT}else y=t.readBytes(2*A),d=new Uint16Array(y.buffer,y.byteOffset,A),g=f.UNSIGNED_SHORT;e&&(d=this.createWireframeIndices(d),g=this.inferIndexType(d));var b=~~(v/o);p.loadData(m,d);for(var _=new Float32Array(3*b),w=new DataView(m.buffer),x=0,T=s;T<m.length;T+=o)_[x++]=w.getFloat32(T,!0),_[x++]=w.getFloat32(T+4,!0),_[x++]=w.getFloat32(T+8,!0);var E=new S.SubMesh(f,f.TRIANGLES,p,_,g,0,A,i);return E.hasWireframe=e,E},s.prototype.inferIndexType=function(t){if(t instanceof Uint8Array)return 5121;if(t instanceof Uint16Array)return 5123;if(t instanceof Uint32Array)return 5125;throw new Error("Invalid index view component type")},s.prototype.createWireframeIndices=function(t){var e=null;(e=t instanceof Uint8Array&&255<3*t.length?new Uint16Array(3*t.length):new Uint32Array(3*t.length)).set(t);for(var r=t.length,i=0;i<t.length;i+=3){var o=t[i],n=t[i+1],a=t[i+2];e[r++]=o,e[r++]=n,e[r++]=n,e[r++]=a,e[r++]=o,e[r++]=a}return e},s.prototype.readOverlay=function(){for(var t=this.reader,e=t.readLEB128(),r=0;r<e;r++){t.readLEB128();var i=t.readLEB128();this.overlays.push(this.textures[i])}},s.prototype.readNodes=function(){var t=this.reader,e=t.readLEB128(),r=new h.SceneNode;if(1&e&&t.readMatrix(r.localTransform),2&e&&t.readMatrix(),4&e){var i=t.readLEB128();r.name=this.stringPool[i]}if(8&e)for(var o=t.readLEB128(),n=0;n<o;n++){var a=this.readNodes();r.addChildNode(a)}if(16&e){var s=t.readLEB128();r.setEntity(this.entities[s])}if(64&e){var u=t.readLEB128();for(n=0;n<u;n++){var l=t.readLEB128(),c=this.materials[l];r.materials.push(c)}}return r},s.prototype.readStringPool=function(){for(var t=this.reader,e=t.readLEB128(),r=0;r<e;r++){var i=t.readString();this.stringPool.push(i)}},s);function s(t){this.stringPool=[],this.textures=[],this.materials=[],this.entities=[],this.chunks=[0,0,0,0,0,0,0,0,0],this.overlays=[],this.renderer=t}e.default=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(o.prototype.readFloat32=function(){var t=this.view.getFloat32(this.ptr,!0);return this.ptr+=4,t},o.prototype.readVector3=function(){var t=this.view.getFloat32(this.ptr,!0),e=this.view.getFloat32(this.ptr+4,!0),r=this.view.getFloat32(this.ptr+8,!0);return this.ptr+=12,[t,e,r]},o.prototype.readMatrix=function(t){void 0===t&&(t=null),t=t||new Float32Array(16);for(var e=this.ptr,r=0;r<16;r++)t[r]=this.view.getFloat32(e,!0),e+=4;return this.ptr=e,t},o.prototype.readInt16=function(){var t=this.view.getInt16(this.ptr,!0);return this.ptr+=2,t},o.prototype.readInt32=function(){var t=this.view.getInt32(this.ptr,!0);return this.ptr+=4,t},o.prototype.readUInt32=function(){var t=this.view.getUint32(this.ptr,!0);return this.ptr+=4,t},o.prototype.readUInt8=function(){var t=this.view.getUint8(this.ptr);return this.ptr++,t},o.prototype.readLEB128=function(){for(var t=this.view,e=this.ptr,r=0,i=0;;){var o=t.getUint8(e++);if(r|=(127&o)<<i,i+=7,0==(128&o))break}return this.ptr=e,r},o.prototype.readBytes=function(t){var e=this.buffer.slice(this.ptr,this.ptr+t);return this.ptr+=t,new Uint8Array(e)},o.prototype.readString=function(){var t=this.readLEB128(),e=this.buffer.slice(this.ptr,this.ptr+t),r=this.decoder.decode(e);return this.ptr+=t,r},Object.defineProperty(o.prototype,"eof",{get:function(){return this.ptr>=this.view.byteLength},enumerable:!0,configurable:!0}),o);function o(t){this.ptr=0,this.decoder=new TextDecoder("utf-8"),this.buffer=t,this.view=new DataView(t)}e.default=i}]);